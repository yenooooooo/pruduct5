<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>HabitFlow</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pretendard@latest/dist/web/static/pretendard.css">

  <style>
    /* ====== Base Variables & Reset ====== */
    :root {
      --bg-color: #f8fafc;
      --text-main: #0f172a;
      --muted: #64748b;
      --card-bg: rgba(255, 255, 255, 0.72);
      --card-border: rgba(15, 23, 42, 0.08);
      --primary: #6366f1;
      --secondary: #a855f7;
      --shadow: 0 20px 25px -5px rgb(0 0 0 / .08), 0 8px 10px -6px rgb(0 0 0 / .06);
    }

    .dark-mode {
      --bg-color: #020617;
      --text-main: #f8fafc;
      --muted: #94a3b8;
      --card-bg: rgba(2, 6, 23, 0.55);
      --card-border: rgba(148, 163, 184, 0.12);
      --shadow: 0 20px 25px -5px rgb(0 0 0 / .45), 0 8px 10px -6px rgb(0 0 0 / .35);
    }

    * { box-sizing: border-box; }
    
    body {
      margin: 0;
      background: var(--bg-color);
      color: var(--text-main);
      font-family: 'Pretendard', system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      overflow-x: hidden;
      transition: background 0.3s, color 0.3s;
    }

    ul { list-style: none; padding: 0; margin: 0; }
    button { font-family: inherit; }

    /* ====== Layout ====== */
    section { width: 100%; padding: 84px 20px; }
    .container { width: 100%; max-width: 1080px; margin: 0 auto; }
    
    /* Header */
    header {
      position: absolute; top: 0; left: 0; right: 0; padding: 20px 0; z-index: 10;
    }
    .header-inner { display: flex; justify-content: space-between; align-items: center; }
    .logo { font-weight: 900; font-size: 1.2rem; display: flex; align-items: center; gap: 8px; }
    .logo-badge { width: 12px; height: 12px; background: var(--primary); border-radius: 50%; }
    
    nav { display: flex; gap: 20px; align-items: center; }
    nav a { text-decoration: none; color: var(--text-main); font-weight: 700; font-size: 14px; }
    
    /* Section Head */
    .section-head { text-align: center; margin-bottom: 36px; }
    .section-head .kicker {
      display: inline-block; padding: 6px 12px; border-radius: 999px;
      font-size: 12px; font-weight: 800; letter-spacing: -0.2px;
      background: rgba(99, 102, 241, 0.12); color: var(--primary);
    }
    .section-head h2 { margin: 12px 0 8px; font-size: 28px; letter-spacing: -0.6px; }
    .section-head p { margin: 0; color: var(--muted); font-size: 15px; line-height: 1.7; }

    /* Glass Effect */
    .glass {
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      box-shadow: var(--shadow);
      backdrop-filter: blur(18px);
      -webkit-backdrop-filter: blur(18px);
      border-radius: 22px;
      transition: 0.25s ease;
    }
    .glass:hover { transform: translateY(-4px); }

    /* ====== Hero ====== */
    .hero {
      padding: 140px 20px 80px;
      background: radial-gradient(800px circle at 80% -20%, rgba(168, 85, 247, 0.15), transparent 60%);
    }
    .hero-grid { display: grid; grid-template-columns: 1.2fr 1fr; gap: 48px; align-items: center; }
    .hero-pill {
      display: inline-block; padding: 8px 14px; border-radius: 999px;
      font-size: 13px; font-weight: 800; background: rgba(99, 102, 241, 0.12); color: var(--primary);
    }
    .hero-title { font-size: 46px; line-height: 1.2; letter-spacing: -1px; margin: 18px 0; }
    .hero-desc { font-size: 16px; color: var(--muted); line-height: 1.7; margin-bottom: 24px; }
    
    .hero-actions { display: flex; gap: 12px; }
    .hero-metrics { display: flex; gap: 14px; margin-top: 28px; }
    .metric-card {
      padding: 14px 18px; border-radius: 16px; background: rgba(255,255,255,0.5);
      border: 1px solid var(--card-border); display: flex; flex-direction: column; gap: 4px; font-size: 13px;
    }
    .hero-right { padding: 26px; }
    .recommend-card {
      background: rgba(255,255,255,0.8); border-radius: 16px; padding: 16px;
      margin-top: 14px; display: flex; flex-direction: column; gap: 6px; font-size: 14px; color: #000;
    }

    /* ====== Problems ====== */
    .problem-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-top: 18px; }
    .problem-card { padding: 18px; text-align: left; }
    .problem-bottom { margin-top: 18px; display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
    .problem-pill {
      padding: 12px 14px; border-radius: 16px; border: 1px dashed var(--card-border);
      background: rgba(255, 255, 255, 0.35); color: var(--text-main); font-weight: 800; text-align: center;
    }

    /* ====== Features ====== */
    .features-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 18px; margin-top: 18px; }
    .feature-card { padding: 22px; text-align: left; position: relative; overflow: hidden; }
    .feature-icon {
      width: 44px; height: 44px; display: grid; place-items: center; border-radius: 14px;
      background: rgba(99, 102, 241, 0.12); color: var(--primary); font-size: 20px; margin-bottom: 12px;
    }

    /* ====== PRO ====== */
    .pro-wrap { padding: 28px; background: linear-gradient(135deg, rgba(99, 102, 241, 0.16), rgba(168, 85, 247, 0.16)); border: 1px solid var(--card-border); }
    .pro-grid { display: grid; grid-template-columns: 1.2fr 1fr; gap: 18px; align-items: center; margin-top: 18px; }
    .pro-list li { display: flex; gap: 10px; align-items: flex-start; margin-bottom: 8px; font-weight: 700; }
    .pro-list li span { color: var(--primary); }
    .pro-badge { padding: 18px; text-align: left; }

    /* ====== Flow & Pricing ====== */
    .flow-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 14px; margin-top: 18px; }
    .step-card { padding: 18px; text-align: left; }
    .step-no {
      width: 30px; height: 30px; border-radius: 10px; display: grid; place-items: center;
      background: rgba(99, 102, 241, 0.14); color: var(--primary); font-weight: 900; margin-bottom: 10px;
    }
    
    .pricing-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-top: 18px; }
    .price-card { padding: 22px; text-align: left; }
    .price-card.pro { border: 2px solid rgba(99, 102, 241, 0.45); position: relative; }
    .price-card.pro::before {
      content: "ì¶”ì²œ"; position: absolute; top: 14px; right: 14px; font-size: 12px;
      font-weight: 900; padding: 6px 10px; border-radius: 999px;
      background: rgba(99, 102, 241, 0.14); color: var(--primary);
    }

    /* ====== Buttons & Inputs ====== */
    .btn {
      appearance: none; border: 1px solid var(--card-border); background: rgba(255, 255, 255, 0.8);
      color: var(--text-main); padding: 14px; border-radius: 14px; font-weight: 900; cursor: pointer;
      transition: all 0.2s ease;
    }
    .btn:active { transform: scale(0.98); }
    .btn-primary {
      border: none !important; background: linear-gradient(135deg, var(--primary), var(--secondary));
      color: #fff; box-shadow: 0 14px 30px rgba(99, 102, 241, 0.25);
    }
    .btn-ghost { background: transparent; color: var(--text-main); border: 1px solid var(--card-border); }
    
    input {
      width: 100%; padding: 14px; margin-bottom: 10px; border-radius: 12px;
      border: 1px solid var(--card-border); background: rgba(255, 255, 255, 0.5); color: var(--text-main);
    }

    /* ====== Auth & App UI ====== */
    .auth-card { max-width: 400px; margin: 0 auto; padding: 30px; text-align: center; }
    .auth-actions { display: flex; gap: 10px; margin-top: 14px; }
    .auth-actions .btn { flex: 1; }
    .link-btn { border: none; background: transparent; color: var(--muted); font-weight: 800; cursor: pointer; text-decoration: underline; margin-top: 10px; }
    
    .tag-container { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 10px; justify-content: center; }
    .theme-tag {
      padding: 6px 12px; border-radius: 20px; border: 1px solid var(--card-border);
      background: transparent; color: var(--text-main); cursor: pointer; font-size: 13px;
    }
    .theme-tag.active { background: var(--primary); color: white; border-color: var(--primary); }

    .habit {
      width: 100%; padding: 20px; font-size: 18px; font-weight: 900; margin-top: 16px;
      border: none; border-radius: 16px; background: var(--text-main); color: var(--bg-color); cursor: pointer;
    }

    /* ====== Badges ====== */
    .badge { padding: 4px 10px; border-radius: 999px; font-size: 12px; font-weight: 800; color: #fff; }
    .tier-bronze { background: #cd7f32; }
    .tier-silver { background: #c0c0c0; color: #333; }
    .tier-gold { background: #ffd700; color: #333; }
    .tier-platinum { background: #e5e4e2; color: #333; border: 1px solid #ccc; }
    .tier-diamond { background: #b9f2ff; color: #333; }
    .tier-master { background: linear-gradient(135deg, #ff00cc, #333399); }

    /* ====== Responsive ====== */
    @media (max-width: 900px) {
      .hero-grid, .problem-grid, .features-grid, .pro-grid, .pricing-grid { grid-template-columns: 1fr; }
      .flow-grid { grid-template-columns: 1fr 1fr; }
      .problem-bottom { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>

  <header>
    <div class="container header-inner">
      <div class="logo">
        <div class="logo-badge"></div>
        HabitFlow
      </div>
      <nav>
        <a href="#features" class="pc-only">ê¸°ëŠ¥</a>
        <a href="#pricing" class="pc-only">ê°€ê²©</a>
        <button class="btn btn-primary" onclick="scrollToAuth()" style="padding: 8px 16px; font-size: 14px;">ì‹œì‘í•˜ê¸°</button>
        <button id="darkModeToggle" class="btn btn-ghost" style="padding: 8px;">ğŸŒ“</button>
      </nav>
    </div>
  </header>  

  <section class="hero">
    <div class="container hero-grid">
      <div class="hero-left">
        <span class="hero-pill">âœ¨ í•˜ë£¨ í•˜ë‚˜ë¡œ ì¶©ë¶„í•´ìš”</span>
        <h1 class="hero-title">í•˜ë£¨ í•˜ë‚˜,<br />ì¸ìƒì„ ë°”ê¾¸ëŠ” ìŠµê´€</h1>
        <p class="hero-desc">
          ì‘ì‹¬ì‚¼ì¼ì„ ëë‚´ëŠ” ê°€ì¥ ë‹¨ìˆœí•œ ë°©ì‹.<br />
          ë²„íŠ¼ í•œ ë²ˆìœ¼ë¡œ ê¸°ë¡í•˜ê³ , ì—°ì† ê¸°ë¡ìœ¼ë¡œ ë™ê¸°ë¶€ì—¬ë¥¼ ìœ ì§€í•˜ì„¸ìš”.
        </p>
        <div class="hero-actions">
          <button class="btn btn-primary" onclick="scrollToAuth()">ì§€ê¸ˆ ì‹œì‘í•˜ê¸°</button>
          <a href="#pricing" class="btn btn-ghost">ê°€ê²© ë³´ê¸°</a>
        </div>
        <div class="hero-metrics">
          <div class="metric-card"><b>1 Habit</b><span>í•˜ë£¨ ë”± í•˜ë‚˜</span></div>
          <div class="metric-card"><b>Streak</b><span>ì—°ì† ê¸°ë¡</span></div>
          <div class="metric-card"><b>Report</b><span>ì£¼ê°„ ë¦¬í¬íŠ¸</span></div>
        </div>
      </div>

      <div class="hero-right glass">
        <h3>ì˜¤ëŠ˜ì˜ ì¶”ì²œ ë£¨í‹´</h3>
        <p>ë¡œê·¸ì¸ í›„ í…Œë§ˆë¥¼ ì„ íƒí•˜ë©´ ì˜¤ëŠ˜ ìŠµê´€ì´ ìë™ìœ¼ë¡œ ì¶”ì²œë¼ìš”.</p>
        <div class="recommend-card">
          <div>ğŸš‘ <b>ìƒì¡´ ì²´ë ¥ íŒ©</b></div>
          <span style="font-size:12px; color:#555">ì§ì¥ì¸ì„ ìœ„í•œ â€œì£½ì§€ ì•Šìœ¼ë ¤ê³  í•˜ëŠ” ìš´ë™â€</span>
        </div>
        <div class="recommend-card">
          <div>âœ¨ <b>ê°“ìƒ ì…ë¬¸ íŒ©</b></div>
          <span style="font-size:12px; color:#555">ì„±ê³µ ë£¨í‹´ì„ 2ë¶„ì§œë¦¬ë¡œ ìª¼ê°œê¸°</span>
        </div>
      </div>
    </div>
  </section>

  <section class="problem">
    <div class="container">
      <div class="section-head">
        <span class="kicker">WHY</span>
        <h2>ì™œ ìŠµê´€ì€ í•­ìƒ ì‹¤íŒ¨í• ê¹Œ?</h2>
        <p>HabitFlowëŠ” â€œë”± 1ê°œë§Œ, ë²„íŠ¼ 1ë²ˆâ€ìœ¼ë¡œ ì‹¤í–‰ ì¥ë²½ì„ ìµœì†Œí™”í•©ë‹ˆë‹¤.</p>
      </div>
      <div class="problem-grid">
        <div class="problem-card glass">
          <h3>ğŸ¯ ëª©í‘œê°€ ë„ˆë¬´ ë§ë‹¤</h3>
          <p>ìš•ì‹¬ì´ ì»¤ì§ˆìˆ˜ë¡ ì‹œì‘ì´ ì–´ë ¤ì›Œì ¸ìš”. í•˜ë£¨ 1ê°œë§Œ ë‚¨ê¹ë‹ˆë‹¤.</p>
        </div>
        <div class="problem-card glass">
          <h3>ğŸ“ ê¸°ë¡ì´ ê·€ì°®ë‹¤</h3>
          <p>ê¸°ë¡ì´ ë²ˆê±°ë¡œìš°ë©´ í¬ê¸° í™•ë¥ ì´ ì˜¬ë¼ê°€ìš”. ë²„íŠ¼ í•œ ë²ˆì´ë©´ ë.</p>
        </div>
        <div class="problem-card glass">
          <h3>ğŸ“‰ ì„±ì·¨ê°€ ëˆˆì— ì•ˆ ë³´ì¸ë‹¤</h3>
          <p>ìŒ“ì´ëŠ” ëŠë‚Œì´ ì—†ìœ¼ë©´ ì§€ì†ì´ ì–´ë µì£ . ì—°ì† ê¸°ë¡ì„ ì¦‰ì‹œ ë³´ì—¬ì¤ë‹ˆë‹¤.</p>
        </div>
      </div>
    </div>
  </section>

  <section id="authSection" style="padding-top: 40px; min-height: 80vh;">
    <div class="container" style="display:flex; justify-content:center;">
      
      <div id="auth" class="auth-card glass">
        <h2>HabitFlow ì‹œì‘í•˜ê¸°</h2>
        <p style="color:var(--muted); margin-bottom:24px;">ì´ë©”ì¼ë¡œ ê°„í¸í•˜ê²Œ ì‹œì‘í•˜ì„¸ìš”</p>
        
        <input id="email" placeholder="ì´ë©”ì¼ ì£¼ì†Œ">
        <input id="password" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸ (6ì ì´ìƒ)">
        
        <div class="auth-actions">
           <button id="signupBtn" class="btn btn-primary" type="button">íšŒì›ê°€ì…</button>
           <button id="signinBtn" class="btn btn-ghost" type="button">ë¡œê·¸ì¸</button>
        </div>
        
        <div style="margin-top:16px;">
          <button id="resetPwBtn" class="link-btn" type="button">ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°</button>
        </div>
        
        <p id="authHint" style="margin-top:20px; font-size:13px; color:var(--muted);">
          ì²˜ìŒì´ë©´ <b>íšŒì›ê°€ì…</b> â†’ ë©”ì¼ ì¸ì¦ í›„ ë¡œê·¸ì¸í•˜ì„¸ìš”.
        </p>
      </div>

      <div id="app" class="glass" style="width:100%; max-width:480px; padding:30px; display:none; text-align:center;">
        <div style="display:flex; justify-content:space-between; align-items:center;">
          <h2 id="welcome" style="margin:0; font-size: 1.2rem;"></h2>
          <button id="logoutBtn" style="background:none; border:none; color:var(--muted); font-size:0.8rem; text-decoration:underline; cursor:pointer;">ë¡œê·¸ì•„ì›ƒ</button>
        </div>

        <div id="tierBadge" style="display:none; margin: 20px 0;">
          <span id="tierText" class="badge"></span>
          <p id="streakCount" style="font-size: 0.9rem; margin-top: 8px; font-weight:700;"></p>
        </div>

        <div id="themeSection" style="margin-top:24px;">
           <p style="font-size: 0.9rem; font-weight: 700; margin-bottom:10px;">ğŸ ì˜¤ëŠ˜ì˜ ë£¨í‹´ íŒ© ì„ íƒ</p>
           <div class="tag-container">
              <button class="theme-tag" onclick="selectTheme(this, 'survival')">ğŸš‘ ìƒì¡´</button>
              <button class="theme-tag" onclick="selectTheme(this, 'godsaeng')">âœ¨ ê°“ìƒ</button>
              <button class="theme-tag" onclick="selectTheme(this, 'detox')">ğŸ“± ë””í†¡ìŠ¤</button>
              <button class="theme-tag" onclick="selectTheme(this, 'custom')">â• ì»¤ìŠ¤í…€</button>
           </div>
        </div>
        
        <div id="todaySuggestion" style="margin-top:16px; font-size:0.9rem; padding:12px; background:rgba(99,102,241,0.1); border-radius:12px; color:var(--text-main);">
          í…Œë§ˆë¥¼ ì„ íƒí•˜ë©´ ì˜¤ëŠ˜ í•  ì¼ì´ ì¶”ì²œë©ë‹ˆë‹¤.
        </div>
        
        <input id="habitName" readonly value="í…Œë§ˆë¥¼ ì„ íƒí•˜ì„¸ìš”" style="margin-top: 20px; text-align: center; font-weight:700;">
        <button id="habitBtn" class="habit">ì˜¤ëŠ˜ ìŠµê´€ ì™„ë£Œ âœ…</button>
        <p id="status" style="margin-top:12px; font-size:14px; color:var(--primary); font-weight:700; min-height:20px;"></p>
        
        <div id="stats" style="display:none; margin-top:20px; padding:16px; background:rgba(255,255,255,0.5); border-radius:12px;">
          <h3 style="margin:0 0 10px; font-size:16px;">ğŸ“Š ë‚˜ì˜ ìŠµê´€ í†µê³„</h3>
          <p id="totalDays" style="margin:0; font-weight:700;"></p>
        </div>

        <button id="restoreStreakBtn" style="margin-top:10px; width:100%; padding:12px; border-radius:12px; background:#f59e0b; color:white; border:none; font-weight:800; display:none; cursor:pointer;">
          ğŸ”¥ ì—°ì† ê¸°ë¡ ë³µêµ¬ (PRO)
        </button>

        <div id="weeklyReport" style="display:none; width: 100%; margin-top: 30px; text-align: left;">
          <div id="weeklyReportBody"></div>
          <div id="weeklyReportLocked" style="display:none; padding: 24px; border: 2px dashed var(--card-border); border-radius: 16px; text-align: center;">
             <span style="font-size: 2rem; display:block; margin-bottom:10px;">ğŸ”’</span>
             <div>
                <b>-ì¼ ì—°ì† ì„±ê³µ</b> ì¤‘ì…ë‹ˆë‹¤!<br>
                AIê°€ ë¶„ì„í•œ <b>'ì‹¤íŒ¨ íŒ¨í„´ ë¦¬í¬íŠ¸'</b>ê°€ ë„ì°©í–ˆìŠµë‹ˆë‹¤.<br>
                PRO íšŒì›ì´ ë˜ì–´ í™•ì¸í•´ë³´ì„¸ìš”.
             </div>
             <button id="weeklyGoProBtn" class="btn btn-primary" style="margin-top: 15px; font-size:13px;">ë¦¬í¬íŠ¸ ì ê¸ˆ í•´ì œí•˜ê¸°</button>
          </div>
        </div>

        <div id="calendarSection" style="display:none; margin-top:30px; text-align:left;">
          <h3 style="font-size:16px; margin-bottom:10px;">ğŸ“… ì´ë²ˆ ë‹¬ ê¸°ë¡</h3>
          <div id="calendarGrid" style="display:grid; grid-template-columns: repeat(7, 1fr); gap:6px;"></div>
        </div>

      </div>

      <div id="adminPanel" class="glass" style="display:none; position:fixed; bottom:20px; right:20px; width:300px; padding:20px; z-index:9999; border:2px solid red;">
        <h3 style="margin-top:0;">ğŸ‘‘ ê´€ë¦¬ì íŒ¨ë„</h3>
        <button id="adminTestBtn" style="margin-bottom:5px;">ê´€ë¦¬ì í…ŒìŠ¤íŠ¸</button>
        <button id="cheatStreakBtn" style="margin-bottom:5px;">5ì¼ ì—°ì† ì„±ê³µ ì¹˜íŠ¸</button>
        <div id="userList" style="margin-top:10px; max-height: 200px; overflow-y:auto; background:#eee; padding:5px; border-radius:8px;"></div>
        <button onclick="document.getElementById('adminPanel').style.display='none'" style="margin-top:10px;">ë‹«ê¸°</button>
      </div>

    </div>
  </section>

  <section id="pricing">
    <div class="container">
      <div class="section-head">
        <span class="kicker">PRICING</span>
        <h2>ê°€ê²©</h2>
        <p>ë¬´ë£Œë¡œ ì‹œì‘í•˜ê³ , íŒ¨í„´ ë¶„ì„ì´ í•„ìš”í•  ë•Œ PROë¡œ ì—…ê·¸ë ˆì´ë“œí•˜ì„¸ìš”.</p>
      </div>
      <div class="pricing-grid">
        <div class="price-card glass">
          <div class="plan">ë¬´ë£Œ</div>
          <div class="amount">â‚©0</div>
          <div class="desc">ê°€ë³ê²Œ ë£¨í‹´ì„ ë§Œë“¤ê³  ì‹¶ì€ ë¶„ì—ê²Œ</div>
          <ul>
            <li>âœ… í•˜ë£¨ 1ìŠµê´€</li>
            <li>âœ… ê¸°ë³¸ í…Œë§ˆ ì¶”ì²œ</li>
            <li>âœ… ê¸°ë³¸ ìŠ¤íŠ¸ë¦­ í™•ì¸</li>
          </ul>
        </div>
        <div class="price-card glass pro" id="proCard">
          <div class="plan">PRO</div>
          <div class="amount">â‚©3,900</div>
          <div class="desc">ìŠµê´€ì´ ë¬´ë„ˆì§€ëŠ” â€œíŒ¨í„´â€ì„ ì¡ê³  ì‹¶ì€ ë¶„ì—ê²Œ</div>
          <ul>
            <li>âœ¨ ìŠµê´€ ë¬´ì œí•œ + ì»¤ìŠ¤í…€</li>
            <li>âœ¨ ì£¼ê°„ ë¦¬í¬íŠ¸/AI ë¶„ì„</li>
            <li>âœ¨ ìº˜ë¦°ë”/í†µê³„/ë³µêµ¬ê¶Œ</li>
          </ul>
          <button id="goProBtn" class="btn btn-primary" style="width:100%; margin-top:14px;">PROë¡œ ì—…ê·¸ë ˆì´ë“œ</button>
        </div>
      </div>
    </div>
  </section>

  <footer>
    <div class="container" style="text-align:center; padding-bottom:40px; color:var(--muted); font-size:14px;">
      <p>Â© 2026 HabitFlow. All rights reserved.</p>
      <p>support@habitflow.app</p>
    </div>
  </footer>

  <div id="bgm" class="glass" style="position:fixed; bottom:20px; left:20px; padding:12px; width:200px; z-index:100;">
    <div style="display:flex; align-items:center; justify-content:space-between; gap:10px;">
      <div style="font-weight:700; font-size:14px;">ğŸµ BGM</div>
      <button id="bgmToggle" style="padding: 4px 10px; border-radius: 8px; border:none; cursor:pointer; background:var(--primary); color:#fff; font-size:11px;">ì¬ìƒ</button>
    </div>
    <div style="margin-top:10px;">
      <input id="bgmVol" type="range" min="0" max="1" step="0.01" value="0.25" style="width:100%;">
      <div style="display:flex; justify-content:space-between; font-size:11px; opacity:0.7;">
        <span>ë³¼ë¥¨</span><span id="bgmVolText">25%</span>
      </div>
    </div>
    <audio id="bgmAudio" src="https://cdn.pixabay.com/download/audio/2022/05/27/audio_1808fbf07a.mp3?filename=lo-fi-116528.mp3" preload="auto" loop></audio>
  </div>

  <div id="proModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.6); align-items:center; justify-content:center; z-index:9999; backdrop-filter:blur(5px);">
    <div class="glass" style="padding:40px; max-width:360px; width:90%; text-align:center; background:#fff;">
      <h2 style="margin-top:0;">ğŸ‘‘ PROë¡œ ì„±ì¥ ê°€ì†</h2>
      <p style="color:var(--muted); line-height:1.6; margin-bottom:20px;">
        ì—°ì† ê¸°ë¡ ë³´í˜¸ê¶Œ<br>
        ì›”ê°„ ìº˜ë¦°ë” ë·°<br>
        AI ì£¼ê°„ íŒ¨í„´ ë¶„ì„
      </p>
      <button id="proModalBtn" class="btn btn-primary" style="width:100%;">PRO ì‹œì‘í•˜ê¸°</button>
      <p style="margin-top:16px; font-size:13px; cursor:pointer; color:var(--muted);" onclick="document.getElementById('proModal').style.display='none'">ë‚˜ì¤‘ì— í• ê²Œìš”</p>
    </div>
  </div>

<script>
  function scrollToAuth() {
    document.getElementById("authSection").scrollIntoView({ behavior: "smooth" });
  }
  function safeText(id, value) {
    const el = document.getElementById(id);
    if (el) el.textContent = value;
  }
</script>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import {
    getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword,
    onAuthStateChanged, signOut, getIdTokenResult, sendPasswordResetEmail, sendEmailVerification
  } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
  import { getFirestore, doc, setDoc, getDoc, collection, getDocs, updateDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAIaroNs2VsMamnnNJV1cP9LdXqIDhl3Ig",
    authDomain: "giiiddd-36340523-3f595.firebaseapp.com",
    projectId: "giiiddd-36340523-3f595",
    storageBucket: "giiiddd-36340523-3f595.firebasestorage.app",
    messagingSenderId: "698901018936",
    appId: "1:698901018936:web:2fb12a7a03cbd844c1e9cd"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  // --- Theme Data ---
  const themeData = {
    survival: ["ğŸ›Œ ë°¤ 11ì‹œ í° ë„ê¸°", "ğŸ’§ ê³µë³µ ë¬¼ í•œ ì”", "ğŸ’Š ì˜ì–‘ì œ ì±™ê²¨ë¨¹ê¸°", "ğŸ¢ ê±°ë¶ëª© ìŠ¤íŠ¸ë ˆì¹­", "ğŸ‘ï¸ ë¨¼ ì‚° ë³´ê¸°", "ğŸ§¹ ì±…ìƒ ìœ„ ë¦¬ì…‹", "ğŸš¶ 30ë¶„ ì‚°ì±…"],
    godsaeng: ["ğŸ“… ë‹¤ìŒ ì£¼ ê³„íš ì§œê¸°", "ğŸ›ï¸ ì´ë¶ˆ ì •ë¦¬í•˜ê¸°", "ğŸ’° ê°€ê³„ë¶€ ì ê¸°", "ğŸ“š ì±… 2í˜ì´ì§€ ì½ê¸°", "ğŸ—£ï¸ ì˜ë‹¨ì–´ 1ê°œ ì™¸ìš°ê¸°", "ğŸ“ ê°ì‚¬ ì¼ê¸° 3ì¤„", "ğŸ§¹ ë°© ì²­ì†Œí•˜ê¸°"],
    detox: ["ğŸ“ ë‚´ì¼ í•  ì¼ ì†ê¸°ë¡", "ğŸ“µ ê¸°ìƒ í›„ 10ë¶„ ë…¸í°", "ğŸ½ï¸ ì‹ì‚¬ ì¤‘ ì˜ìƒ ê¸ˆì§€", "ğŸ§ ì´ì–´í° ì—†ì´ ê±·ê¸°", "ğŸ“± ìŠ¤í¬ë¦° íƒ€ì„ í™•ì¸", "ğŸ§˜ 5ë¶„ ëª…ìƒ", "ğŸ“µ ë””ì§€í„¸ í”„ë¦¬ 1ì‹œê°„"]
  };

  // --- Helper Functions ---
  function dateKeyFromOffset(daysAgo) {
    const d = new Date();
    d.setDate(d.getDate() - daysAgo);
    return d.toISOString().slice(0, 10);
  }

  async function getConsecutiveStreak(uid) {
    let count = 0;
    let date = new Date();
    while (true) {
      const key = date.toISOString().slice(0, 10);
      const snap = await getDoc(doc(db, "users", uid, "habits", key));
      if (!snap.exists()) break;
      count++;
      date.setDate(date.getDate() - 1);
    }
    return count;
  }

  function requireEmailPass() {
    const emailEl = document.getElementById("email");
    const passEl = document.getElementById("password");
    if (!emailEl?.value || !passEl?.value) {
      alert("ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");
      return false;
    }
    if (passEl.value.length < 6) {
      alert("ë¹„ë°€ë²ˆí˜¸ëŠ” 6ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.");
      return false;
    }
    return true;
  }

  // --- Window Global Functions ---
  window.selectTheme = async (el, themeType) => {
    const user = auth.currentUser;
    if (!user) return alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");

    const tokenResult = await getIdTokenResult(user);
    const isPro = tokenResult.claims.pro === true;
    const habitInput = document.getElementById("habitName");
    const dayIdx = new Date().getDay();

    document.querySelectorAll('.theme-tag').forEach(tag => tag.classList.remove('active'));

    if (themeType === 'custom') {
      if (!isPro) {
        alert("ğŸ”’ ì»¤ìŠ¤í…€ ìŠµê´€ì€ PRO ì „ìš©ì…ë‹ˆë‹¤.");
        return;
      }
      habitInput.readOnly = false;
      habitInput.value = "";
      habitInput.placeholder = "ì›í•˜ëŠ” ìŠµê´€ì„ ì…ë ¥í•˜ì„¸ìš”";
      habitInput.style.background = "#fff";
      habitInput.focus();
    } else {
      habitInput.readOnly = true;
      habitInput.style.background = "var(--bg-color)";
      habitInput.value = themeData[themeType][dayIdx];
    }
    if (el) el.classList.add('active');
  };

  // --- DOM Elements ---
  const authDiv = document.getElementById('auth');
  const appDiv = document.getElementById('app');
  const emailInput = document.getElementById("email");
  const passInput = document.getElementById("password");
  const signupBtn = document.getElementById("signupBtn");
  const signinBtn = document.getElementById("signinBtn");
  const resetPwBtn = document.getElementById("resetPwBtn");
  const logoutBtn = document.getElementById("logoutBtn");
  const habitBtn = document.getElementById('habitBtn');
  
  // PRO & Admin UI
  const proCard = document.getElementById("proCard");
  const statsDiv = document.getElementById("stats");
  const adminPanel = document.getElementById("adminPanel");
  const restoreBtn = document.getElementById("restoreStreakBtn");
  const weeklyReport = document.getElementById("weeklyReport");

  // --- Auth Event Listeners ---
  signupBtn.onclick = async () => {
    if (!requireEmailPass()) return;
    try {
      const cred = await createUserWithEmailAndPassword(auth, emailInput.value, passInput.value);
      await sendEmailVerification(cred.user);
      alert("âœ… íšŒì›ê°€ì… ì™„ë£Œ! ì¸ì¦ ë©”ì¼ì„ í™•ì¸í•´ì£¼ì„¸ìš”.");
      await signOut(auth);
    } catch (e) {
      alert("ê°€ì… ì‹¤íŒ¨: " + e.message);
    }
  };

  signinBtn.onclick = async () => {
    if (!requireEmailPass()) return;
    try {
      const cred = await signInWithEmailAndPassword(auth, emailInput.value, passInput.value);
      if (!cred.user.emailVerified) {
         await signOut(auth);
         alert("ğŸ“© ì´ë©”ì¼ ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤. ë©”ì¼í•¨ì„ í™•ì¸í•´ì£¼ì„¸ìš”.");
      } else {
         alert("âœ… ë¡œê·¸ì¸ ì„±ê³µ!");
      }
    } catch (e) {
      alert("ë¡œê·¸ì¸ ì‹¤íŒ¨: " + e.message);
    }
  };

  resetPwBtn.onclick = async () => {
    if (!emailInput.value) return alert("ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
    try {
      await sendPasswordResetEmail(auth, emailInput.value);
      alert("ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ë©”ì¼ì„ ë³´ëƒˆìŠµë‹ˆë‹¤.");
    } catch(e) { alert("ì˜¤ë¥˜: " + e.message); }
  };

  logoutBtn.onclick = () => signOut(auth);

  // --- Core Logic ---
  onAuthStateChanged(auth, async user => {
    if (!user) {
      authDiv.style.display = 'block';
      appDiv.style.display = 'none';
      adminPanel.style.display = 'none';
      return;
    }
    
    // ì´ë©”ì¼ ì¸ì¦ ì²´í¬
    if (!user.emailVerified) {
      authDiv.style.display = 'block';
      appDiv.style.display = 'none';
      return;
    }
     // ğŸ”’ ê´€ë¦¬ì ì•„ë‹ˆë©´ ì´ë©”ì¼ ì¸ì¦ í•„ìˆ˜
  if (!isAdmin && !user.emailVerified) {
    alert("ğŸ“© ì´ë©”ì¼ ì¸ì¦ í›„ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.\në©”ì¼í•¨ì„ í™•ì¸í•´ì£¼ì„¸ìš”.");
    await signOut(auth);
    return;
  }
  if (isAdmin) {
    welcome.innerText = `ğŸ‘‘ ê´€ë¦¬ì ${user.email}`;
    adminPanel.style.display = "block";
  } else {
    welcome.innerText = `ğŸ‘‹ ${user.email}`;
    adminPanel.style.display = "none";
  }

    // ë¡œê·¸ì¸ ì™„ë£Œ UI ì²˜ë¦¬
    authDiv.style.display = 'none';
    appDiv.style.display = 'block';
    
    // ê¸°ë³¸ ì¶”ì²œ ì„¸íŒ…
    const dayIdx = new Date().getDay();
    document.getElementById("todaySuggestion").innerHTML = 
      `ğŸ‘‰ ì˜¤ëŠ˜ ì¶”ì²œ: <b>${themeData.survival[dayIdx]}</b> (ê¸°ë³¸)`;

    try {
      const tokenResult = await getIdTokenResult(user, true);
      const isAdmin = tokenResult.claims.admin === true;
      const isPro = tokenResult.claims.pro === true;

      document.getElementById("welcome").textContent = `ğŸ‘‹ ${user.email.split('@')[0]}ë‹˜`;

      // Admin
      if (isAdmin) {
        adminPanel.style.display = 'block';
        loadAllUsers();
      }

      // PRO UI Switch
      if (isPro) {
        proCard.style.display = "none";
        statsDiv.style.display = "block";
        safeText("status", "ğŸŒŸ PRO ë©¤ë²„ì‹­ ì´ìš© ì¤‘");
        loadStats(user.uid);
      } else {
        proCard.style.display = "block";
        statsDiv.style.display = "none";
        safeText("status", "ğŸŒ± ë¬´ë£Œ íšŒì› (í•˜ë£¨ 1ìŠµê´€)");
      }

      // Load Data
      const streak = await getConsecutiveStreak(user.uid);
      updateTierUI(streak);
      await updateWeeklyReport(user.uid, isPro);
      await renderCalendar(user.uid, isPro);
      await updateStreakProtectionUI(user.uid, isPro);
      
      // 7ì¼ ë‹¬ì„± íŒì—… (ë¬´ë£ŒíšŒì› ëŒ€ìƒ)
      if (!isPro && streak >= 7) showProModal();

    } catch (e) {
      console.error("Auth init error:", e);
    }
  });

  // --- Habit Actions ---
  habitBtn.onclick = async () => {
    const user = auth.currentUser;
    if (!user) return;
    
    const habitName = document.getElementById("habitName").value;
    if (habitName === "í…Œë§ˆë¥¼ ì„ íƒí•˜ì„¸ìš”" || !habitName.trim()) {
      alert("í…Œë§ˆë¥¼ ì„ íƒí•˜ê±°ë‚˜ ìŠµê´€ì„ ì…ë ¥í•˜ì„¸ìš”!");
      return;
    }
    
    const todayStr = new Date().toISOString().slice(0, 10);
    const ref = doc(db, "users", user.uid, "habits", todayStr);
    
    await setDoc(ref, {
      done: true,
      name: habitName,
      timestamp: new Date()
    });

    celebrate();
    
    const streak = await getConsecutiveStreak(user.uid);
    updateTierUI(streak);
  };

  function celebrate() {
    const btn = document.getElementById("habitBtn");
    btn.style.transform = "scale(1.05)";
    setTimeout(() => { btn.style.transform = "scale(1)"; }, 200);
    safeText("status", "ğŸ‰ ì˜¤ëŠ˜ì˜ ìŠµê´€ ì™„ë£Œ! ë‚´ì¼ë„ ë§Œë‚˜ìš”.");
    btn.textContent = "ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤ ğŸ‘";
    btn.disabled = true;
    btn.style.opacity = "0.7";
  }

  // --- UI Update Functions ---
  function updateTierUI(streak) {
    const tierBadge = document.getElementById("tierBadge");
    const tierText = document.getElementById("tierText");
    const streakCount = document.getElementById("streakCount");

    tierBadge.style.display = "block";
    streakCount.textContent = `ğŸ”¥ í˜„ì¬ ${streak}ì¼ ì—°ì† ì„±ê³µ ì¤‘!`;

    let label = "ğŸ¥‰ BRONZE";
    let cls = "tier-bronze";
    if (streak >= 30) { label = "ğŸ† GRANDMASTER"; cls = "tier-master"; }
    else if (streak >= 20) { label = "ğŸ’ DIAMOND"; cls = "tier-diamond"; }
    else if (streak >= 14) { label = "âœ¨ PLATINUM"; cls = "tier-platinum"; }
    else if (streak >= 7) { label = "ğŸ¥‡ GOLD"; cls = "tier-gold"; }
    else if (streak >= 3) { label = "ğŸ¥ˆ SILVER"; cls = "tier-silver"; }

    tierText.textContent = label;
    tierText.className = "badge " + cls;
  }

  async function updateWeeklyReport(uid, isPro) {
    const reportBody = document.getElementById("weeklyReportBody");
    const lockedDiv = document.getElementById("weeklyReportLocked");
    const reportDiv = document.getElementById("weeklyReport");
    
    // ìµœê·¼ 7ì¼ ë°ì´í„° ì¡°íšŒ
    let successCount = 0;
    const days = [];
    const dayNames = ["ì¼", "ì›”", "í™”", "ìˆ˜", "ëª©", "ê¸ˆ", "í† "];
    
    for (let i = 0; i < 7; i++) {
       const key = dateKeyFromOffset(i);
       const snap = await getDoc(doc(db, "users", uid, "habits", key));
       const done = snap.exists();
       const d = new Date(key);
       if (done) successCount++;
       days.push({ key, done, dayName: dayNames[d.getDay()] });
    }

    const streak = await getConsecutiveStreak(uid);
    if (streak < 3) {
      reportDiv.style.display = "none";
      return;
    }
    reportDiv.style.display = "block";

    if (!isPro) {
      reportBody.innerHTML = "";
      lockedDiv.style.display = "block";
      document.querySelector("#weeklyReportLocked b").textContent = `${streak}ì¼ ì—°ì† ì„±ê³µ`;
      return;
    }

    // PRO logic
    lockedDiv.style.display = "none";
    const rate = Math.round((successCount/7)*100);
    const listHTML = days.reverse().map(d => `
       <div style="display:flex; justify-content:space-between; margin-bottom:6px; font-size:13px;">
         <span>${d.dayName} (${d.key.slice(5)})</span>
         <span>${d.done ? "âœ…" : "âŒ"}</span>
       </div>
    `).join('');

    reportBody.innerHTML = `
      <div style="background:rgba(99,102,241,0.1); padding:16px; border-radius:12px; margin-bottom:12px;">
         <div style="font-weight:700; margin-bottom:8px;">ğŸ¤– AI Habit Coach</div>
         <div style="font-size:13px; line-height:1.5;">
            ì´ë²ˆ ì£¼ ì„±ê³µë¥ ì€ <b>${rate}%</b>ì…ë‹ˆë‹¤.<br>
            ${rate === 100 ? "ì™„ë²½í•©ë‹ˆë‹¤! ê°“ìƒ ê·¸ ìì²´ì‹œë„¤ìš”." : "ì£¼ë§ì— ì¡°ê¸ˆ ë” ì‹ ê²½ì¨ë³´ë©´ ì–´ë–¨ê¹Œìš”?"}
         </div>
      </div>
      <div style="padding:10px; background:#fff; border-radius:12px; border:1px solid #eee;">
         ${listHTML}
      </div>
    `;
  }

  async function renderCalendar(uid, isPro) {
    const section = document.getElementById("calendarSection");
    const grid = document.getElementById("calendarGrid");
    
    if (!isPro) {
      section.style.display = "none";
      return;
    }
    section.style.display = "block";
    grid.innerHTML = "";

    const now = new Date();
    const year = now.getFullYear();
    const month = now.getMonth();
    const lastDay = new Date(year, month + 1, 0).getDate();

    for (let d = 1; d <= lastDay; d++) {
      const dateStr = `${year}-${String(month+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
      const snap = await getDoc(doc(db, "users", uid, "habits", dateStr));
      
      const cell = document.createElement("div");
      cell.textContent = d;
      cell.style.padding = "6px";
      cell.style.borderRadius = "6px";
      cell.style.fontSize = "12px";
      cell.style.textAlign = "center";
      
      if (snap.exists()) {
        cell.style.background = "#22c55e";
        cell.style.color = "white";
      } else {
        cell.style.background = "rgba(0,0,0,0.05)";
        cell.style.color = "var(--muted)";
      }
      grid.appendChild(cell);
    }
  }

  async function updateStreakProtectionUI(uid, isPro) {
    if (!isPro) return;
    const snap = await getDoc(doc(db, "users", uid));
    const left = snap.data()?.streakProtectionLeft ?? 2;
    
    if (left > 0) {
      restoreBtn.style.display = "block";
      restoreBtn.textContent = `ğŸ”¥ ì—°ì† ê¸°ë¡ ë³µêµ¬ (${left}íšŒ ë‚¨ìŒ)`;
      restoreBtn.onclick = async () => {
         const yesterday = dateKeyFromOffset(1);
         await setDoc(doc(db, "users", uid, "habits", yesterday), { done: true, restored: true });
         await updateDoc(doc(db, "users", uid), { streakProtectionLeft: left - 1 });
         alert("ğŸ”¥ ì–´ì œ ê¸°ë¡ì´ ë³µêµ¬ë˜ì—ˆìŠµë‹ˆë‹¤!");
         location.reload();
      };
    } else {
      restoreBtn.style.display = "none";
    }
  }

  async function loadStats(uid) {
    let count = 0;
    const snap = await getDocs(collection(db, "users", uid, "habits"));
    safeText("totalDays", `ì´ ëˆ„ì  ì„±ê³µ: ${snap.size}ì¼`);
  }

  // --- Admin Functions ---
  async function loadAllUsers() {
    const listDiv = document.getElementById("userList");
    listDiv.innerHTML = "ë¡œë”© ì¤‘...";
    const snap = await getDocs(collection(db, "users"));
    listDiv.innerHTML = "";
    
    snap.forEach(docSnap => {
      const data = docSnap.data();
      const div = document.createElement("div");
      div.style.padding = "8px";
      div.style.borderBottom = "1px solid #ccc";
      div.innerHTML = `
        <span style="font-size:11px;">${docSnap.id.slice(0,5)}...</span> 
        <b>${data.isPro ? "PRO" : "FREE"}</b>
        <button class="tgl" style="font-size:10px; margin-left:5px;">ë³€ê²½</button>
      `;
      div.querySelector(".tgl").onclick = async () => {
         await updateDoc(doc(db, "users", docSnap.id), { isPro: !data.isPro });
         alert("ë“±ê¸‰ ë³€ê²½ë¨. ìƒˆë¡œê³ ì¹¨ í•˜ì„¸ìš”.");
      };
      listDiv.appendChild(div);
    });
  }

  const cheatBtn = document.getElementById("cheatStreakBtn");
  if(cheatBtn) {
    cheatBtn.onclick = async () => {
       const user = auth.currentUser;
       if (!user) return alert("ë¡œê·¸ì¸ í•„ìš”");
       if (!confirm("ì§€ë‚œ 5ì¼ ë°ì´í„°ë¥¼ ê°•ì œ ì„±ê³µ ì²˜ë¦¬í• ê¹Œìš”?")) return;
       for(let i=0; i<5; i++) {
          const k = dateKeyFromOffset(i);
          await setDoc(doc(db, "users", user.uid, "habits", k), { done: true, cheat: true });
       }
       alert("ì¹˜íŠ¸ ì ìš© ì™„ë£Œ! ìƒˆë¡œê³ ì¹¨í•˜ì„¸ìš”.");
       location.reload();
    };
  }

  // --- Modal Helpers ---
  window.showProModal = () => document.getElementById("proModal").style.display = "flex";
  
  // --- Dark Mode ---
  const toggle = document.getElementById("darkModeToggle");
  toggle.onclick = () => {
    document.body.classList.toggle("dark-mode");
    localStorage.setItem("darkMode", document.body.classList.contains("dark-mode") ? "on" : "off");
  };
  if (localStorage.getItem("darkMode") === "on") document.body.classList.add("dark-mode");

</script>

<script>
  // BGM Logic (Vanilla JS)
  const audio = document.getElementById("bgmAudio");
  const bgmBtn = document.getElementById("bgmToggle");
  const vol = document.getElementById("bgmVol");
  const volText = document.getElementById("bgmVolText");

  if (audio && bgmBtn) {
    audio.volume = 0.25;
    bgmBtn.onclick = () => {
      if (audio.paused) {
        audio.play().then(() => bgmBtn.textContent = "ì¼ì‹œì •ì§€").catch(() => alert("ìë™ ì¬ìƒ ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤."));
      } else {
        audio.pause();
        bgmBtn.textContent = "ì¬ìƒ";
      }
    };
    vol.oninput = () => {
      audio.volume = vol.value;
      volText.textContent = Math.round(vol.value * 100) + "%";
    };
  }
</script>

</body>
</html>