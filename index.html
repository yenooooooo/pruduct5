<!DOCTYPE html>
<html lang="ko">
<head>
Â  <meta charset="UTF-8" />
Â  <title>HabitFlow - Ultimate God Mode</title>
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
Â Â 
Â  <link href="https://cdn.jsdelivr.net/gh/sunn-us/SUIT/fonts/static/woff2/SUIT.css" rel="stylesheet">
Â  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

Â  <style>
Â  Â  /* ====== âœ¨ Core Variables ====== */
Â  Â  :root {
Â  Â  Â  --bg-color: #f8fafc;
Â  Â  Â  --text-main: #0f172a;
Â  Â  Â  --text-muted: #64748b;
Â  Â  Â  --card-bg: rgba(255, 255, 255, 0.85);
Â  Â  Â  --card-border: rgba(255, 255, 255, 0.6);
Â  Â  Â  --panel-bg: #ffffff;
Â  Â  Â  --input-bg: rgba(241, 245, 249, 0.8);
Â  Â  Â  --primary: #6366f1;
Â  Â  Â  --secondary: #a855f7;
Â  Â  Â  --accent: #f59e0b;
Â  Â  Â  --shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.08);
Â  Â  Â  --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
Â  Â  }

Â  Â  body.dark-mode {
Â  Â  Â  --bg-color: #0f172a;
Â  Â  Â  --text-main: #f1f5f9;
Â  Â  Â  --text-muted: #94a3b8;
Â  Â  Â  --card-bg: rgba(30, 41, 59, 0.75);
Â  Â  Â  --card-border: rgba(255, 255, 255, 0.08);
Â  Â  Â  --panel-bg: #1e293b;
Â  Â  Â  --input-bg: rgba(15, 23, 42, 0.6);
Â  Â  Â  --shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.5);
Â  Â  Â  --glass-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
Â  Â  }

Â  Â  * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
Â  Â Â 
Â  Â  body {
Â  Â  Â  margin: 0; font-family: 'SUIT', sans-serif;
Â  Â  Â  background: var(--bg-color); color: var(--text-main);
Â  Â  Â  overflow-x: hidden; transition: background 0.3s, color 0.3s;
Â  Â  Â  min-height: 100vh; position: relative;
Â  Â  }

Â  Â  /* ====== Animations ====== */
Â  Â  @keyframes pulse { 0% { transform: scale(0.95); opacity: 0.7; } 100% { transform: scale(1.05); opacity: 1; } }
Â  Â  @keyframes fadeIn { from { opacity:0; transform:translateY(10px); } to { opacity:1; transform:translateY(0); } }
Â  Â  @keyframes fireScale { 0% { transform: scale(1) rotate(-5deg); } 100% { transform: scale(1.2) rotate(5deg); } }

Â  Â  /* ====== UI Components ====== */
Â  Â  ul { list-style: none; padding: 0; margin: 0; }
Â  Â  button { font-family: inherit; }

Â  Â  section { width: 100%; padding: 84px 20px; position: relative; z-index: 1; pointer-events: none; }
Â  Â  .container, .glass, button, input, .card, .price-card, .workout-side-panel, .problem-card, .memo-panel { pointer-events: auto; }
Â  Â  .container { width: 100%; max-width: 1080px; margin: 0 auto; }
Â  Â Â 
Â  Â  header { position: absolute; top: 0; left: 0; right: 0; padding: 20px 0; z-index: 10; pointer-events: auto; }
Â  Â  .header-inner { display: flex; justify-content: space-between; align-items: center; }
Â  Â  .logo { font-weight: 900; font-size: 1.2rem; display: flex; align-items: center; gap: 8px; color: var(--text-main); }
Â  Â  .logo-badge { width: 12px; height: 12px; background: var(--primary); border-radius: 50%; }
Â  Â Â 
Â  Â  nav { display: flex; gap: 12px; align-items: center; }
Â  Â  .pc-only { display: block; }
Â  Â  @media (max-width: 600px) { .pc-only { display: none; } }
Â  Â Â 
Â  Â  .glass {
Â  Â  Â  background: var(--card-bg); border: 1px solid var(--card-border);
Â  Â  Â  box-shadow: var(--glass-shadow); backdrop-filter: blur(16px);
Â  Â  Â  border-radius: 24px; transition: transform 0.25s ease;
Â  Â  }
Â  Â  .glass:hover { transform: translateY(-4px); }

Â  Â  .hero { padding-top: 140px; padding-bottom: 80px; }
Â  Â  .hero-grid { display: grid; grid-template-columns: 1.2fr 1fr; gap: 48px; align-items: center; }
Â  Â  .hero-pill { display: inline-block; padding: 8px 14px; border-radius: 999px; font-size: 13px; font-weight: 800; background: rgba(99, 102, 241, 0.15); color: var(--primary); }
Â  Â  .hero-title { font-size: 46px; line-height: 1.2; letter-spacing: -1px; margin: 18px 0; font-weight: 900; color: var(--text-main); }
Â  Â  .hero-desc { font-size: 16px; color: var(--text-muted); line-height: 1.7; margin-bottom: 24px; }
Â  Â  .hero-metrics { display: flex; gap: 14px; margin-top: 28px; }
Â  Â  .metric-card { padding: 14px 18px; border-radius: 16px; background: var(--input-bg); border: 1px solid var(--card-border); display: flex; flex-direction: column; gap: 4px; font-size: 13px; color: var(--text-main); }
Â  Â  .recommend-card { background: var(--card-bg); border-radius: 24px; padding: 30px; margin-top: 20px; display: flex; flex-direction: column; gap: 8px; font-size: 15px; color: var(--text-main); border: 1px solid var(--card-border); box-shadow: var(--shadow); transition: opacity 0.5s ease-in-out; min-height: 140px; justify-content: center; }

Â  Â  .problem-section { padding-top: 40px; padding-bottom: 60px; }
Â  Â  .section-head { text-align: center; margin-bottom: 36px; }
Â  Â  .section-head .kicker { display: inline-block; padding: 6px 12px; border-radius: 999px; font-size: 12px; font-weight: 800; background: rgba(99, 102, 241, 0.15); color: var(--primary); }
Â  Â  .section-head h2 { margin: 12px 0 8px; font-size: 28px; color: var(--text-main); }
Â  Â  .section-head p { color: var(--text-muted); }
Â  Â  .problem-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-top: 18px; }
Â  Â  .problem-card { padding: 24px; text-align: left; display: flex; flex-direction: column; gap: 10px; background: var(--card-bg); border-radius: 24px; border: 1px solid var(--card-border); box-shadow: var(--shadow); }
Â  Â  .problem-card h3 { margin:0; font-size: 18px; color: var(--text-main); }
Â  Â  .problem-card p { margin:0; font-size: 14px; color: var(--text-muted); line-height: 1.5; }

Â  Â  .dashboard-layout { display: flex; justify-content: center; align-items: flex-start; gap: 24px; max-width: 960px; margin: 0 auto; display: none; }
Â  Â  #app { flex: 1; max-width: 480px; padding: 30px; text-align: center; position: relative; z-index: 10; width: 100%; }
Â  Â  .right-stack { display: flex; flex-direction: column; gap: 20px; width: 340px; flex-shrink: 0; }

Â  Â  .workout-side-panel { width: 100%; background: linear-gradient(145deg, #1e293b, #0f172a); color: white; padding: 24px; border-radius: 24px; border: 1px solid rgba(255, 255, 255, 0.1); box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.5); display: none; text-align: left; position: relative; overflow: hidden; }
Â  Â  .master-badge-corner { position: absolute; top: 16px; right: 16px; background: rgba(251, 191, 36, 0.2); color: #fbbf24; border: 1px solid #fbbf24; font-size: 10px; font-weight: 800; padding: 4px 8px; border-radius: 6px; letter-spacing: 1px; }
Â  Â  .w-title { font-size: 18px; font-weight: 800; margin-bottom: 20px; background: linear-gradient(to right, #fff, #94a3b8); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
Â  Â  .workout-tabs { display: flex; background: rgba(0,0,0,0.3); padding: 4px; border-radius: 12px; margin-bottom: 20px; }
Â  Â  .w-tab { flex: 1; border: none; background: transparent; color: #94a3b8; padding: 8px; font-size: 13px; font-weight: 700; border-radius: 8px; cursor: pointer; transition: 0.2s; }
Â  Â  .w-tab.active { background: #fbbf24; color: #000; box-shadow: 0 4px 12px rgba(251, 191, 36, 0.3); }
Â  Â  .workout-display { background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 16px; padding: 24px 10px; text-align: center; margin-bottom: 20px; min-height: 100px; display: flex; align-items: center; justify-content: center; flex-direction: column; }
Â  Â  .wd-main { font-size: 20px; font-weight: 800; margin-bottom: 4px; color: #fff; }
Â  Â  .wd-sub { font-size: 12px; color: #94a3b8; }
Â  Â  .workout-anim { animation: pulse 0.5s infinite alternate; color: #fbbf24; font-size: 24px; font-weight: 900; }

Â  Â  .memo-panel { width: 100%; padding: 20px; text-align: left; position: relative; display: flex; flex-direction: column; gap: 10px; overflow: hidden; }
Â  Â  .memo-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px; }
Â  Â  .memo-title { font-weight: 800; font-size: 16px; color: var(--text-main); display: flex; align-items: center; gap: 6px; }
Â  Â  .memo-badge { font-size: 10px; padding: 2px 6px; border-radius: 4px; background: var(--primary); color: white; font-weight: 700; }
Â  Â  textarea.memo-input { width: 100%; height: 100px; border: none; border-radius: 12px; background: var(--input-bg); color: var(--text-main); padding: 12px; font-family: inherit; font-size: 14px; line-height: 1.5; resize: none; outline: none; box-shadow: inset 0 2px 4px rgba(0,0,0,0.05); }
Â  Â  .memo-history-list { max-height: 150px; overflow-y: auto; display: flex; flex-direction: column; gap: 8px; }
Â  Â  .memo-item { background: var(--input-bg); padding: 10px; border-radius: 10px; font-size: 13px; color: var(--text-main); border: 1px solid var(--card-border); }
Â  Â  .memo-date { font-size: 11px; color: var(--text-muted); margin-bottom: 4px; font-weight: 700; }

Â  Â  .panel-lock { position: absolute; inset: 0; background: rgba(0,0,0,0.1); backdrop-filter: blur(8px); display: flex; flex-direction: column; align-items: center; justify-content: center; border-radius: 24px; z-index: 10; color: var(--text-main); font-weight: 800; text-align: center; padding: 20px; }

Â  Â  .pricing-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-top: 18px; }
Â  Â  .price-card { padding: 24px; text-align: left; display:flex; flex-direction:column; justify-content: space-between; height: 100%; background: var(--card-bg); border-radius: 24px; border: 1px solid var(--card-border); box-shadow: var(--shadow); }
Â  Â  .price-card .plan { font-size: 13px; font-weight: 800; color: var(--text-muted); margin-bottom: 4px; text-transform: uppercase; }
Â  Â  .price-card .amount { font-size: 24px; font-weight: 900; margin-bottom: 4px; letter-spacing: -1px; color: var(--text-main); }
Â  Â  .price-card .desc { font-size: 12px; color: var(--text-muted); margin-bottom: 15px; min-height: 32px; }
Â  Â  .price-card ul { margin-bottom: 15px; padding: 0; list-style: none; }
Â  Â  .price-card li { display: flex; gap: 6px; font-size: 12px; margin-bottom: 6px; align-items: center; font-weight: 500; color: var(--text-main); }
Â  Â  .price-card.pro { border: 2px solid var(--primary); }
Â  Â  .price-card.ultra { border: 2px solid var(--accent); }
Â  Â  .price-card.master { border: 2px solid #333; background: linear-gradient(135deg, #1e1e1e, #0f172a); box-shadow: 0 10px 30px rgba(0,0,0,0.3); transform: scale(1.03); z-index: 2; position: relative; }
Â  Â  .price-card.master .plan { color: #ffd700; }
Â  Â  .price-card.master .desc { color: #94a3b8; }
Â  Â  .price-card.master .amount, .price-card.master li { color: #fff; }
Â  Â  .price-card.master .btn { background: #ffd700; color: #000; border:none; font-weight: 900; }

Â  Â  .auth-card { max-width: 400px; margin: 0 auto; padding: 30px; text-align: center; }
Â  Â  .btn { padding: 12px; border-radius: 12px; font-weight: 900; cursor: pointer; border:1px solid var(--card-border); background: var(--panel-bg); color: var(--text-main); width:100%; transition:0.2s; box-shadow: var(--shadow); }
Â  Â  .btn:active { transform: scale(0.95); }
Â  Â  .btn-primary { border:none; background: linear-gradient(135deg, var(--primary), var(--secondary)); color: #fff; }
Â  Â  input { width: 100%; padding: 14px; margin-bottom: 10px; border-radius: 12px; border: 1px solid var(--card-border); background: var(--input-bg); color: var(--text-main); }

Â  Â  .tag-container { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 10px; justify-content: center; }
Â  Â  .theme-tag { padding: 6px 12px; border-radius: 20px; border: 1px solid var(--card-border); background: transparent; cursor: pointer; font-size: 13px; color: var(--text-main); }
Â  Â  .theme-tag.active { background: var(--primary); color: white; border-color: var(--primary); }

Â  Â  .aura-effect { position: relative; }
Â  Â  .aura-effect::before { content: ''; position: absolute; top: -15px; left: -15px; right: -15px; bottom: -15px; border-radius: 50%; background: linear-gradient(45deg, #ff0000, #ff7300, #fffb00, #48ff00, #00ffd5, #002bff, #7a00ff, #ff00c8, #ff0000); background-size: 400%; z-index: -1; filter: blur(25px); animation: glowing 20s linear infinite; opacity: 0.5; }
Â  Â  @keyframes glowing { 0% { background-position: 0 0; } 50% { background-position: 400% 0; } 100% { background-position: 0 0; } }

Â  Â  .pet-container { display: flex; flex-direction: column; align-items: center; justify-content: center; margin: 20px 0; cursor: pointer; transition: transform 0.2s; }
Â  Â  .pet-emoji { font-size: 80px; animation: bounce 2s infinite; filter: drop-shadow(0 10px 10px rgba(0,0,0,0.15)); }
Â  Â  .pet-bubble { background: var(--panel-bg); color: var(--text-main); padding: 8px 16px; border-radius: 20px; font-size: 13px; font-weight: bold; position: relative; margin-bottom: 10px; opacity: 0; transition: opacity 0.3s; box-shadow: var(--shadow); }
Â  Â Â 
Â  Â  .sticker { position: absolute; font-size: 40px; cursor: grab; user-select: none; z-index: 50; transition: transform 0.1s; filter: drop-shadow(2px 4px 6px rgba(0,0,0,0.15)); }
Â  Â  .sticker:active { cursor: grabbing; transform: scale(1.1); }

Â  Â  .heatmap-grid { display: grid; grid-template-columns: repeat(20, 1fr); gap: 4px; margin-top: 10px; justify-content: center; }
Â  Â  .grass { width: 100%; aspect-ratio: 1; border-radius: 3px; background: rgba(0,0,0,0.08); }
Â  Â  .grass.active { background: #22c55e; }

Â  Â  .blob-cont { position: fixed; top: 0; left: 0; width: 100%; height: 100vh; z-index: 0; overflow: hidden; pointer-events: none; }
Â  Â  .blob { position: absolute; border-radius: 50%; opacity: 0.6; filter: blur(60px); animation: float 10s infinite alternate; }
Â  Â  .blob-1 { top: 10%; left: 10%; width: 300px; height: 300px; background: var(--secondary); animation-duration: 25s; }
Â  Â  .blob-2 { bottom: 20%; right: 10%; width: 350px; height: 350px; background: var(--primary); animation-duration: 30s; }
Â  Â  .blob-3 { bottom: 10%; left: 30%; width: 250px; height: 250px; background: #ec4899; animation-duration: 22s; }
Â  Â  @keyframes float { 0% { transform: translate(0, 0); } 100% { transform: translate(40px, 60px); } }
Â  Â  @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

Â  Â  @media (max-width: 900px) {
Â  Â  Â  Â  .hero-grid, .pricing-grid, .problem-grid, .dashboard-layout { grid-template-columns: 1fr; flex-direction: column; align-items: center; }
Â  Â  Â  Â  .workout-side-panel, .right-stack { width: 100%; max-width: 480px; }
Â  Â  Â  Â  .admin-shell { grid-template-columns: 1fr; }
Â  Â  Â  Â  .admin-left { display: none; }
Â  Â  }

Â  Â  /* ===================================================================== */
Â  Â  /* ğŸ‘‘ GOD MODE ADMIN & NEW FEATURES */
Â  Â  /* ===================================================================== */
Â  Â  #adminPanel { display:none; position: fixed; inset: 0; z-index: 10000; background: rgba(0,0,0,0.85); backdrop-filter: blur(12px); padding: 20px; animation: fadeIn 0.3s; }
Â  Â  .admin-shell { width: 100%; max-width: 1400px; height: 90vh; margin: 0 auto; border-radius: 20px; overflow: hidden; display: grid; grid-template-columns: 260px 1fr; background: #111; box-shadow: 0 0 100px rgba(99,102,241,0.2); border: 1px solid #333; }
Â  Â Â 
Â  Â  .admin-left { padding: 20px; background: #000; border-right: 1px solid #333; display:flex; flex-direction:column; }
Â  Â  .admin-right { padding: 30px; overflow-y:auto; background: #0a0a0a; color: #eee; }
Â  Â Â 
Â  Â  .admin-title { font-weight: 1000; font-size: 24px; color: #fff; margin-bottom: 5px; display: flex; align-items: center; gap: 10px; }
Â  Â  .admin-sub { color: #666; font-size: 11px; margin-bottom: 30px; letter-spacing: 1px; font-family: monospace; }

Â  Â  .adminNavBtn { width:100%; padding: 14px 16px; border-radius: 8px; border: none; background: transparent; cursor: pointer; font-weight: 700; text-align:left; color:#888; margin-bottom: 5px; transition: 0.2s; }
Â  Â  .adminNavBtn:hover { background: #222; color: #fff; }
Â  Â  .adminNavBtn.active { background: linear-gradient(90deg, #6366f1, #4f46e5); color: #fff; box-shadow: 0 4px 15px rgba(99,102,241,0.3); }
Â  Â Â 
Â  Â  .admin-cards { display:grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 30px; }
Â  Â  .admin-card { padding: 20px; border-radius: 12px; background: #1a1a1a; border: 1px solid #333; }
Â  Â  .admin-card .k { color: #888; font-size: 12px; font-weight: 800; text-transform: uppercase; }
Â  Â  .admin-card .v { font-size: 32px; font-weight: 1000; margin-top: 10px; color: #fff; }

Â  Â  /* Matrix Terminal */
Â  Â  .matrix-bg { position: absolute; inset: 0; pointer-events: none; opacity: 0.1; z-index: 0; background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCI+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZpbGw9IiMwZjAiIGZvbnQtZmFtaWx5PSJtb25vc3BhY2UiIGZvbnQtc2l6ZT0iMTIiIHRleHQtYW5jaG9yPSJtaWRkbGUiPjEwPC90ZXh0Pjwvc3ZnPg=='); }
Â  Â  .matrix-terminal { background: #000; color: #00ff41; padding: 20px; border-radius: 12px; font-family: 'Courier New', monospace; height: 250px; overflow-y: auto; font-size: 12px; line-height: 1.5; border: 1px solid #0f0; box-shadow: inset 0 0 30px rgba(0, 255, 0, 0.1); margin-top: 20px; position: relative; z-index: 1; }
Â  Â  .log-line { margin-bottom: 4px; display: flex; }
Â  Â  .log-line span { opacity: 0.5; margin-right: 10px; }

Â  Â  .admin-table { width:100%; border-collapse: collapse; margin-top: 20px; }
Â  Â  .admin-table th { text-align: left; padding: 15px; color: #666; font-size: 12px; border-bottom: 1px solid #333; text-transform: uppercase; }
Â  Â  .admin-table td { padding: 15px; border-bottom: 1px solid #222; font-size: 14px; color: #ddd; }
Â  Â Â 
Â  Â  .admin-pane { display:none; animation: fadeIn 0.3s; }
Â  Â  .admin-pane.active { display:block; }

Â  Â  /* Admin Close Button */
Â  Â  .admin-close-x { position: absolute; top: 20px; right: 20px; background: transparent; border: none; color: #fff; font-size: 24px; cursor: pointer; opacity: 0.6; transition: 0.2s; z-index: 20; }
Â  Â  .admin-close-x:hover { opacity: 1; color: #ef4444; }

Â  Â  /* Visual Charts (CSS based) */
Â  Â  .chart-container { display: flex; gap: 5px; height: 10px; width: 100%; margin-top: 10px; background: #222; border-radius: 5px; overflow: hidden; }
Â  Â  .chart-bar { height: 100%; transition: width 0.5s; }
Â  Â  .chart-legend { display: flex; gap: 15px; margin-top: 5px; font-size: 11px; color: #888; }
Â  Â  .dot { width: 8px; height: 8px; border-radius: 50%; display: inline-block; margin-right: 5px; }

Â  Â  /* New User Features */
Â  Â  .live-ticker { position: fixed; bottom: 0; left: 0; width: 100%; background: rgba(0,0,0,0.8); backdrop-filter: blur(10px); color: white; padding: 8px 0; z-index: 9000; overflow: hidden; white-space: nowrap; font-size: 13px; font-weight: 700; border-top: 1px solid rgba(255,255,255,0.1); }
Â  Â  .ticker-content { display: inline-block; animation: ticker 30s linear infinite; padding-left: 100%; }
Â  Â  .ticker-item { display: inline-flex; align-items: center; gap: 6px; margin-right: 40px; }
Â  Â  @keyframes ticker { 0% { transform: translateX(0); } 100% { transform: translateX(-100%); } }

Â  Â  .zen-overlay { position: fixed; inset: 0; background: var(--bg-color); z-index: 20000; display: none; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
Â  Â  .zen-circle { width: 150px; height: 150px; border-radius: 50%; background: linear-gradient(135deg, var(--primary), var(--secondary)); opacity: 0.3; animation: breathe 4s infinite ease-in-out; margin-bottom: 30px; }
Â  Â  @keyframes breathe { 0%, 100% { transform: scale(1); opacity: 0.3; } 50% { transform: scale(1.5); opacity: 0.6; } }

Â  Â  .broadcast-overlay { position: fixed; top: 100px; left: 50%; transform: translateX(-50%); background: rgba(239, 68, 68, 0.9); color: white; padding: 15px 30px; border-radius: 50px; font-weight: 900; box-shadow: 0 10px 30px rgba(239, 68, 68, 0.4); z-index: 30000; display: none; animation: slideDown 0.5s; }
Â  Â  @keyframes slideDown { from { top: -100px; } to { top: 100px; } }

Â  Â  .achievement-toast { position: fixed; top: 20px; right: 20px; background: linear-gradient(135deg, #ffd700, #f59e0b); color: #000; padding: 15px 20px; border-radius: 12px; font-weight: 800; box-shadow: 0 10px 30px rgba(245, 158, 11, 0.4); z-index: 25000; display: none; align-items: center; gap: 10px; animation: slideInRight 0.5s; }
Â  Â  @keyframes slideInRight { from { transform: translateX(100%); } to { transform: translateX(0); } }

Â  Â  /* Hearts Animation */
Â  Â  .cheer-heart { position: fixed; font-size: 24px; animation: floatUp 3s linear forwards; z-index: 9999; pointer-events: none; }
Â  Â  @keyframes floatUp { 0% { transform: translateY(0) scale(1); opacity: 1; } 100% { transform: translateY(-100vh) scale(1.5); opacity: 0; } }
Â  </style>
</head>
<body>

Â  <div id="liveTicker" class="live-ticker">
Â  Â  <div class="ticker-content" id="tickerContent">
Â  Â  Â  <div class="ticker-item">âš¡ HabitFlow LIVE: ì „ ì„¸ê³„ ìœ ì €ë“¤ì´ ê°“ìƒì„ ì‚´ê³  ìˆìŠµë‹ˆë‹¤.</div>
Â  Â  </div>
Â  </div>

Â  <div id="zenOverlay" class="zen-overlay">
Â  Â  <div class="zen-circle"></div>
Â  Â  <h2 style="font-weight:300; margin-bottom:10px;">Deep Focus</h2>
Â  Â  <p style="color:var(--text-muted);">ì˜¤ì§ ë‚˜ì—ê²Œë§Œ ì§‘ì¤‘í•˜ì„¸ìš”.</p>
Â  Â  <button class="btn btn-ghost" onclick="toggleZenMode()" style="margin-top:30px;">ë‚˜ê°€ê¸°</button>
Â  </div>

Â  <div id="broadcastOverlay" class="broadcast-overlay">
Â  Â  ğŸ“¢ <span id="broadcastMsg">ê¸´ê¸‰ ê³µì§€ì‚¬í•­ì…ë‹ˆë‹¤.</span>
Â  </div>

Â  <div id="achievementToast" class="achievement-toast">
Â  Â  <div style="font-size:24px;">ğŸ†</div>
Â  Â  <div>
Â  Â  Â  <div style="font-size:10px; opacity:0.8;">ACHIEVEMENT UNLOCKED</div>
Â  Â  Â  <div id="achievementTitle">ì‘ì‹¬ì‚¼ì¼ íƒˆì¶œ!</div>
Â  Â  </div>
Â  </div>

Â  <div class="blob-cont">
Â  Â  <div class="blob blob-1"></div>
Â  Â  <div class="blob blob-2"></div>
Â  Â  <div class="blob blob-3"></div>
Â  </div>

Â  <div id="stickerLayer" style="position: absolute; top:0; left:0; width:100%; height:100%; overflow:hidden; pointer-events:none; z-index:5;"></div>

Â  <div id="coinDisplay" style="position: fixed; top: 20px; right: 20px; z-index: 500; background: var(--panel-bg); padding: 8px 12px; border-radius: 20px; font-weight: 800; font-size: 14px; display:none; border: 2px solid var(--accent); color: var(--text-main); box-shadow: var(--shadow);">
Â  Â  Â  <span>â­</span> <span id="coinCount">0</span>
Â  </div>

Â  <header>
Â  Â  <div class="container header-inner">
Â  Â  Â  <div class="logo"><div class="logo-badge"></div>HabitFlow</div>
Â  Â  Â  <nav>
Â  Â  Â  Â  <button class="btn" onclick="toggleZenMode()" style="padding: 8px 12px; width:auto;">ğŸ§˜</button>
Â  Â  Â  Â  <button class="btn btn-primary" onclick="scrollToAuth()" style="padding: 8px 16px; font-size: 14px; width:auto;">ì‹œì‘í•˜ê¸°</button>
Â  Â  Â  Â  <button id="darkModeToggle" class="btn btn-ghost" style="padding: 8px; width:auto;">ğŸŒ“</button>
Â  Â  Â  </nav>
Â  Â  </div>
Â  </header>Â Â 

Â  <div id="topBanner" style="display:none; position:fixed; top:70px; z-index:9998; width:100%; padding:12px 18px; background: rgba(99,102,241,0.12); border-bottom:1px solid rgba(99,102,241,0.20); color: var(--text-main); font-weight: 900; text-align:center; backdrop-filter: blur(10px);"></div>

Â  <section class="hero">
Â  Â  <div class="container hero-grid">
Â  Â  Â  <div class="hero-left">
Â  Â  Â  Â  <span class="hero-pill">âœ¨ í•˜ë£¨ í•˜ë‚˜ë¡œ ì¶©ë¶„í•´ìš”</span>
Â  Â  Â  Â  <h1 class="hero-title">í•˜ë£¨ í•˜ë‚˜,<br />ì¸ìƒì„ ë°”ê¾¸ëŠ” ìŠµê´€</h1>
Â  Â  Â  Â  <p class="hero-desc">ì‘ì‹¬ì‚¼ì¼ì„ ëë‚´ëŠ” ê°€ì¥ ë‹¨ìˆœí•œ ë°©ì‹.<br>ë²„íŠ¼ í•œ ë²ˆìœ¼ë¡œ ê¸°ë¡í•˜ê³ , ì—°ì† ê¸°ë¡ìœ¼ë¡œ ë™ê¸°ë¶€ì—¬ë¥¼ ìœ ì§€í•˜ì„¸ìš”.</p>
Â  Â  Â  Â  <div class="hero-actions">
Â  Â  Â  Â  Â  <button class="btn btn-primary" style="width:auto;" onclick="scrollToAuth()">ì§€ê¸ˆ ì‹œì‘í•˜ê¸°</button>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="hero-metrics">
Â  Â  Â  Â  Â  <div class="metric-card"><b>1 Habit</b><span>í•˜ë£¨ ë”± í•˜ë‚˜</span></div>
Â  Â  Â  Â  Â  <div class="metric-card"><b>Streak</b><span>ì—°ì† ê¸°ë¡</span></div>
Â  Â  Â  Â  Â  <div class="metric-card"><b>Report</b><span>ì£¼ê°„ ë¦¬í¬íŠ¸</span></div>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  Â  <div class="hero-right glass">
Â  Â  Â  Â  <h3 style="margin-top:0;">ì˜¤ëŠ˜ì˜ ì¶”ì²œ ë£¨í‹´</h3>
Â  Â  Â  Â  <p style="color:var(--text-muted); font-size:14px;">ë¡œê·¸ì¸ í›„ í…Œë§ˆë¥¼ ì„ íƒí•˜ë©´ ë§¤ì¼ ë‹¤ë¥¸ ë£¨í‹´ì´ ì¶”ì²œë©ë‹ˆë‹¤.</p>
Â  Â  Â  Â  <div id="heroRecommendCard" class="recommend-card fade-anim" style="transition: opacity 0.5s;">
Â  Â  Â  Â  Â  <div>ğŸš‘ <b>ìƒì¡´ ì²´ë ¥ íŒ©</b></div>
Â  Â  Â  Â  Â  <span style="font-size:12px; color:var(--text-muted);">ì§ì¥ì¸ì„ ìœ„í•œ "ì£½ì§€ ì•Šìœ¼ë ¤ê³  í•˜ëŠ” ìš´ë™"</span>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  </div>
Â  </section>

Â  <section id="authSection" style="padding-top: 40px; min-height: 80vh;">
Â  Â  <div class="container" style="display:flex; justify-content:center;">
Â  Â  Â  <div id="auth" class="auth-card glass">
Â  Â  Â  Â  <h2>HabitFlow ì‹œì‘í•˜ê¸°</h2>
Â  Â  Â  Â  <input id="email" placeholder="ì´ë©”ì¼ ì£¼ì†Œ">
Â  Â  Â  Â  <input id="password" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸ (6ì ì´ìƒ)">
Â  Â  Â  Â  <div class="auth-actions">
Â  Â  Â  Â  Â  Â <button id="signupBtn" class="btn btn-primary">íšŒì›ê°€ì…</button>
Â  Â  Â  Â  Â  Â <button id="signinBtn" class="btn btn-ghost">ë¡œê·¸ì¸</button>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div style="margin-top:10px;"><button id="resetPwBtn" class="link-btn">ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°</button></div>
Â  Â  Â  </div>

Â  Â  Â  <div id="dashboardLayout" class="dashboard-layout">
Â  Â  Â  Â  Â  <div id="app" class="glass">
Â  Â  Â  Â  Â  Â  <div style="display:flex; justify-content:space-between; align-items:center;">
Â  Â  Â  Â  Â  Â  Â  <h2 id="welcome" style="margin:0; font-size: 1.2rem;"></h2>
Â  Â  Â  Â  Â  Â  Â  <button id="logoutBtn" style="background:none; border:none; color:var(--text-muted); font-size:0.8rem; text-decoration:underline; cursor:pointer;">ë¡œê·¸ì•„ì›ƒ</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div style="margin: 10px 0 10px;">
Â  Â  Â  Â  Â  Â  Â  <div style="display:flex; justify-content:space-between; align-items:flex-end; margin-bottom:5px;">
Â  Â  Â  Â  Â  Â  Â  Â  <span id="levelBadge" style="font-weight:900; color:var(--primary); font-size:18px;">Lv.1</span>
Â  Â  Â  Â  Â  Â  Â  Â  <span id="xpText" style="font-size:12px; color:var(--text-muted); font-weight:700;">0 / 100 XP</span>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  <div style="background:rgba(0,0,0,0.08); border-radius:10px; height:10px; overflow:hidden; position:relative;">
Â  Â  Â  Â  Â  Â  Â  Â  <div id="xpBar" style="background:linear-gradient(90deg, var(--primary), var(--secondary)); width:0%; height:100%; transition: width 0.6s; border-radius:10px;"></div>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="pet-container" id="petContainer">
Â  Â  Â  Â  Â  Â  Â  Â  <div id="petBubble" class="pet-bubble">ì‘ì›í•©ë‹ˆë‹¤!</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="petEmoji" class="pet-emoji">ğŸ¥š</div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <button id="globalCheerBtn" class="btn" style="background: #fff0f7; color: #ec4899; border: 1px solid #ec4899; width: 100%; margin-bottom: 15px;">
Â  Â  Â  Â  Â  Â  Â  Â  ğŸ’– ëª¨ë‘ì—ê²Œ ì‘ì› ë³´ë‚´ê¸°
Â  Â  Â  Â  Â  Â  </button>

Â  Â  Â  Â  Â  Â  <div class="heatmap-container" style="margin: 15px 0; padding: 15px; border-radius: 16px; background: rgba(0,0,0,0.05); border: 1px solid var(--card-border);">
Â  Â  Â  Â  Â  Â  Â  Â <div style="font-size:12px; font-weight:700; color:var(--text-muted); display:flex; justify-content:space-between; margin-bottom: 5px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â <span>ğŸŒ¿ ìµœê·¼ 20ì¼</span><span>Log</span>
Â  Â  Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  Â  Â  Â <div id="heatmapGrid" class="heatmap-grid"></div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div id="tierBadge" style="display:none; margin: 20px 0;">
Â  Â  Â  Â  Â  Â  Â  <span id="tierText" class="badge"></span>
Â  Â  Â  Â  Â  Â  Â  <p id="streakCount" style="font-size: 0.9rem; margin-top: 8px; font-weight:700;"></p>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div id="themeSection" style="margin-top:24px;">
Â  Â  Â  Â  Â  Â  Â  Â <p style="font-size: 0.9rem; font-weight: 700; margin-bottom:10px;">ğŸ ì˜¤ëŠ˜ì˜ ë£¨í‹´ íŒ©</p>
Â  Â  Â  Â  Â  Â  Â  Â <div class="tag-container">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="theme-tag" onclick="selectTheme(this, 'survival')">ğŸš‘ ìƒì¡´</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="theme-tag" onclick="selectTheme(this, 'godsaeng')">âœ¨ ê°“ìƒ</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="theme-tag" onclick="selectTheme(this, 'detox')">ğŸ“± ë””í†¡ìŠ¤</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="theme-tag" onclick="selectTheme(this, 'custom')">â• ì»¤ìŠ¤í…€</button>
Â  Â  Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div id="todaySuggestion" style="margin-top:16px; font-size:0.9rem; padding:12px; background:rgba(99,102,241,0.1); border-radius:12px; color:var(--text-main);">í…Œë§ˆë¥¼ ì„ íƒí•˜ì„¸ìš”.</div>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <input id="habitName" readonly value="í…Œë§ˆë¥¼ ì„ íƒí•˜ì„¸ìš”" style="margin-top: 20px; text-align: center; font-weight:700;">
Â  Â  Â  Â  Â  Â  <div style="display:flex; gap:8px; margin-top:10px;">
Â  Â  Â  Â  Â  Â  Â  Â  <button id="habitBtn" class="btn btn-primary">ì˜¤ëŠ˜ ìŠµê´€ ì™„ë£Œ âœ…</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button id="timerBtn" class="btn" style="width:60px; background:#333; color:white; display:none;">â±ï¸</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <p id="status" style="margin-top:12px; font-size:14px; color:var(--primary); font-weight:700; min-height:20px;"></p>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div id="stats" style="display:none; margin-top:20px; padding:16px; background:rgba(0,0,0,0.05); border-radius:12px;">
Â  Â  Â  Â  Â  Â  Â  <h3 style="margin:0 0 10px; font-size:16px;">ğŸ“Š í†µê³„</h3>
Â  Â  Â  Â  Â  Â  Â  <p id="totalDays" style="margin:0; font-weight:700;"></p>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <button id="restoreStreakBtn" style="margin-top:10px; width:100%; padding:12px; border-radius:12px; background:var(--accent); color:white; border:none; display:none;">ğŸ”¥ ì—°ì† ê¸°ë¡ ë³µêµ¬</button>

Â  Â  Â  Â  Â  Â  <div id="weeklyReport" style="display:none; width: 100%; margin-top: 30px; text-align: left;">
Â  Â  Â  Â  Â  Â  Â  <div id="weeklyReportBody"></div>
Â  Â  Â  Â  Â  Â  Â  <div id="weeklyReportLocked" style="display:none; padding: 24px; border: 2px dashed var(--card-border); border-radius: 16px; text-align: center;">
Â  Â  Â  Â  Â  Â  Â  Â  Â ğŸ”’ PRO íšŒì›ì´ ë˜ì–´ ë¦¬í¬íŠ¸ë¥¼ í™•ì¸í•˜ì„¸ìš”.
Â  Â  Â  Â  Â  Â  Â  Â  Â <button class="btn btn-primary" style="margin-top: 15px; font-size:13px;" onclick="showProModal('PRO')">ì ê¸ˆ í•´ì œ</button>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div id="calendarSection" style="display:none; margin-top:30px; text-align:left;">
Â  Â  Â  Â  Â  Â  Â  <h3 style="font-size:16px; margin-bottom:10px;">ğŸ“… ìº˜ë¦°ë”</h3>
Â  Â  Â  Â  Â  Â  Â  <div id="calendarGrid" style="display:grid; grid-template-columns: repeat(7, 1fr); gap:6px;"></div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <div class="right-stack">
Â  Â  Â  Â  Â  Â  Â  <div id="workoutSidePanel" class="workout-side-panel">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="master-badge-corner">MASTER</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="w-title">ğŸ”¥ ì˜¤ëŠ˜ì˜ ì±Œë¦°ì§€</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="workout-tabs">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="w-tab active" onclick="selectWorkoutTab('walk')">ğŸš¶ ê±·ê¸°</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="w-tab" onclick="selectWorkoutTab('run')">ğŸƒ ë‹¬ë¦¬ê¸°</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="w-tab" onclick="selectWorkoutTab('gym')">ğŸ‹ï¸ í—¬ìŠ¤</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="workout-display">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="workoutResult" class="wd-main">â“</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="wd-sub">ì¢…ëª© ì„ íƒ í›„ ë¯¸ì…˜ ë½‘ê¸°!</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <button id="startWorkoutBtn" class="btn" style="background:var(--accent); color:#000; border:none; font-weight:900; box-shadow:0 4px 15px rgba(251,191,36,0.4);">ğŸ° ë¯¸ì…˜ ëœë¤ ë½‘ê¸°</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <button id="completeWorkoutBtn" class="btn" style="background:linear-gradient(to right, #22c55e, #16a34a); color:#fff; border:none; display:none;">âœ… ì™„ë£Œ (ì½”ì¸ 3ë°°)</button>
Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  <div id="memoPanel" class="glass memo-panel" style="display:none;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="memo-header">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="memo-title">ğŸ“ ì˜¤ëŠ˜ì˜ ë©”ëª¨</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="memo-badge">PRO+</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="memoLocked" class="panel-lock">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="font-size:30px; margin-bottom:10px;">ğŸ”’</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div>PRO ë“±ê¸‰ë¶€í„° ì‚¬ìš© ê°€ëŠ¥</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn btn-primary" style="margin-top:15px; width:auto; padding:8px 16px; font-size:12px;" onclick="showProModal('PRO')">ì ê¸ˆ í•´ì œ</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <textarea id="dailyMemo" class="memo-input" placeholder="ì˜¤ëŠ˜ì˜ ë‹¤ì§ì´ë‚˜ í•  ì¼ì„ ê¸°ë¡í•˜ì„¸ìš”..."></textarea>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <button id="saveMemoBtn" class="btn btn-primary" style="margin-top:10px;">ğŸ’¾ ì €ì¥í•˜ê¸°</button>
Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  <div id="memoHistoryPanel" class="glass memo-panel" style="display:none;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="memo-header">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="memo-title">ğŸ“‚ ì§€ë‚œ ë©”ëª¨ ê¸°ë¡</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="memoHistoryList" class="memo-history-list">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="text-align:center; padding:10px; color:var(--text-muted); font-size:13px;">ê¸°ë¡ëœ ë©”ëª¨ê°€ ì—†ìŠµë‹ˆë‹¤.</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>Â 
Â  Â  Â  </div>
Â  Â  </div>
Â  </section>

Â  <section id="pricing">
Â  Â  <div class="container">
Â  Â  Â  <div class="section-head">
Â  Â  Â  Â  <span class="kicker">PRICING</span>
Â  Â  Â  Â  <h2>ê°€ê²©</h2>
Â  Â  Â  Â  <p>ë‹¹ì‹ ì˜ ì„±ì¥ì„ ê°€ì†í™”í•  ìµœì ì˜ í”Œëœì„ ì„ íƒí•˜ì„¸ìš”.</p>
Â  Â  Â  </div>
Â  Â  Â  <div class="pricing-grid">
Â  Â  Â  Â  <div class="price-card glass">
Â  Â  Â  Â  Â  <div><div class="plan">ë¬´ë£Œ</div><div class="amount">â‚©0</div><div class="desc">ê°€ë³ê²Œ ì‹œì‘í•˜ëŠ” ì…ë¬¸ììš©</div><ul><li>âœ… í•˜ë£¨ 1ìŠµê´€ ê¸°ë¡</li><li>âœ… ê¸°ë³¸ í…Œë§ˆ ì¶”ì²œ</li></ul></div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="price-card glass pro">
Â  Â  Â  Â  Â  <div><div class="plan" style="color:var(--primary);">PRO</div><div class="amount">â‚©3,900</div><div class="desc">ìŠµê´€ íŒ¨í„´ì„ ì¡ê³  ì‹¶ì€ ë¶„</div><ul><li>âœ¨ ìŠµê´€ ë¬´ì œí•œ + ì»¤ìŠ¤í…€</li><li>âœ¨ ì£¼ê°„ AI ë¶„ì„ ë¦¬í¬íŠ¸</li><li>âœ¨ ìº˜ë¦°ë” ë·° / ë³µêµ¬ê¶Œ</li><li>ğŸ“ <b>ì˜¤ëŠ˜ì˜ ë©”ëª¨ & íˆìŠ¤í† ë¦¬</b></li></ul></div>
Â  Â  Â  Â  Â  <button class="btn btn-primary" onclick="showProModal('PRO')">PRO ì—…ê·¸ë ˆì´ë“œ</button>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="price-card glass ultra">
Â  Â  Â  Â  Â  <div><div class="plan" style="color:var(--accent);">ULTRA</div><div class="amount">â‚©5,900</div><div class="desc">ë‚˜ë§Œì˜ ê°ì„±ìœ¼ë¡œ ê¾¸ë¯¸ê¸°</div><ul><li>ğŸŒˆ ì•± ì»¬ëŸ¬ í…Œë§ˆ ë³€ê²½</li><li>ğŸµ BGM ì„ ê³¡ê¶Œ (ë¹—ì†Œë¦¬ ë“±)</li><li>ğŸ’° ì½”ì¸ íšë“ 2ë°°</li><li>ğŸ‘‘ PRO ê¸°ëŠ¥ ëª¨ë‘ í¬í•¨</li></ul></div>
Â  Â  Â  Â  Â  <button class="btn btn-primary" style="background:linear-gradient(135deg, #f59e0b, #d97706);" onclick="showProModal('ULTRA')">ULTRA ì—…ê·¸ë ˆì´ë“œ</button>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="price-card glass master">
Â  Â  Â  Â  Â  <div><div class="plan">MASTER</div><div class="amount">â‚©7,900</div><div class="desc">ê·¹í•œì˜ ì„±ì¥ì„ ìœ„í•œ ì™„ì „ì²´</div><ul><li>ğŸ’ª <b>ë§¤ì¼ ìš´ë™ ì±Œë¦°ì§€ íŒ¨ë„</b></li><li>â±ï¸ í¬ëª¨ë„ë¡œ ì§‘ì¤‘ íƒ€ì´ë¨¸</li><li>âœ¨ ë§ˆìŠ¤í„° ì „ìš© ì˜¤ë¼ ì´í™íŠ¸</li><li>ğŸ’° ì½”ì¸ íšë“ 3ë°°</li></ul></div>
Â  Â  Â  Â  Â  <button class="btn" onclick="showProModal('MASTER')">MASTER ì—…ê·¸ë ˆì´ë“œ</button>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  </div>
Â  </section>

Â  <footer><div class="container" style="text-align:center; padding-bottom:40px; color:var(--text-muted); font-size:14px;"><p>Â© 2026 HabitFlow. All rights reserved.</p></div></footer>

Â  <button id="trashModeBtn" style="display:none; position:fixed; bottom:50px; right:140px; z-index:9990; width:50px; height:50px; border-radius:50%; border:none; background:var(--accent); color:white; font-size:22px; cursor:pointer; box-shadow:0 4px 12px rgba(0,0,0,0.3);">ğŸ—‘ï¸</button>
Â  <button id="themeBtn" style="display:none; position:fixed; bottom:50px; right:200px; z-index:9990; width:50px; height:50px; border-radius:50%; border:none; background:#ec4899; color:white; font-size:22px; cursor:pointer; box-shadow:0 4px 12px rgba(0,0,0,0.3);">ğŸ¨</button>
Â  <button id="shopOpenBtn" style="display:none; position:fixed; bottom:50px; right:80px; z-index:9990; width:50px; height:50px; border-radius:50%; border:none; background:#8b5cf6; color:white; font-size:22px; cursor:pointer; box-shadow:0 4px 12px rgba(0,0,0,0.3);">ğŸ</button>
Â  <button id="rankOpenBtn" style="display:none; position:fixed; bottom:50px; right:20px; z-index:9990; width:50px; height:50px; border-radius:50%; border:none; background:var(--accent); color:white; font-size:24px; cursor:pointer; box-shadow:0 4px 12px rgba(0,0,0,0.3);">ğŸ†</button>
Â  <button id="adminOpenBtn" style="display:none; position:fixed; bottom:50px; left:20px; z-index:9990; width:50px; height:50px; border-radius:50%; border:none; background:#000; color:#0f0; border:2px solid #0f0; font-size:24px; cursor:pointer; box-shadow:0 0 20px #0f0;">ğŸ˜</button>
Â  <button id="bgmOpenBtn" style="display:none; position:fixed; bottom:50px; left:80px; z-index:99999; width:40px; height:40px; border-radius:50%; border:none; background:var(--panel-bg); color:var(--text-main); font-size:22px; cursor:pointer; box-shadow:0 4px 12px rgba(0,0,0,0.2); backdrop-filter: blur(5px);">ğŸµ</button>

Â  <div id="shopPanel" class="glass" style="display:none; position:fixed; bottom:110px; right:20px; width:300px; padding:20px; z-index:10000; border:2px solid #8b5cf6; background:var(--panel-bg);">
Â  Â  <div style="display:flex; justify-content:space-between; margin-bottom:15px;"><h3 style="margin:0; color:#7c3aed;">ğŸ ìƒì </h3><button class="close-btn" onclick="this.parentElement.parentElement.style.display='none'">âœ–</button></div>
Â  Â  <div style="text-align:center; margin-bottom:20px;"><div style="font-size:60px;">ğŸ”®</div><button id="gachaBtn" class="btn btn-primary" style="margin-top:10px;">1ì½”ì¸ ë½‘ê¸°! (ë³´ìœ : <span id="shopCoinCount">0</span>)</button></div>
Â  Â  <div style="font-size:12px; font-weight:bold; margin-bottom:5px;">ğŸ’ ë‚´ ìŠ¤í‹°ì»¤</div>
Â  Â  <div id="inventoryList" style="height:150px; overflow-y:auto; background:var(--input-bg); padding:10px; border-radius:8px; display:grid; grid-template-columns:repeat(4,1fr); gap:10px;"></div>
Â  </div>

Â  <div id="rankPanel" class="glass" style="display:none; position:fixed; bottom:110px; right:20px; width:340px; padding:20px; z-index:10000; border:2px solid var(--accent); background:var(--panel-bg);">
Â  Â  <div style="display:flex; justify-content:space-between; margin-bottom:15px;"><h3 style="margin:0; color:var(--accent);">ğŸ† ëª…ì˜ˆì˜ ì „ë‹¹</h3><button class="close-btn" onclick="this.parentElement.parentElement.style.display='none'">âœ–</button></div>
Â  Â  <div id="rankList" style="height:300px; overflow-y:auto; background:var(--input-bg); padding:10px; border-radius:8px;"></div>
Â  </div>

Â  <div id="themePanel" class="glass" style="display:none; position:fixed; bottom:110px; right:120px; width:200px; padding:20px; z-index:10000; background:var(--panel-bg);">
Â  Â  <div style="margin-bottom:10px; font-weight:bold;">ğŸ¨ í…Œë§ˆ (ULTRA+)</div>
Â  Â  <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
Â  Â  Â  Â  <button onclick="changeTheme('purple')" style="background:#6366f1; height:40px; border-radius:8px; border:none;"></button>
Â  Â  Â  Â  <button onclick="changeTheme('blue')" style="background:#3b82f6; height:40px; border-radius:8px; border:none;"></button>
Â  Â  Â  Â  <button onclick="changeTheme('pink')" style="background:#ec4899; height:40px; border-radius:8px; border:none;"></button>
Â  Â  Â  Â  <button onclick="changeTheme('gold')" style="background:#d97706; height:40px; border-radius:8px; border:none;"></button>
Â  Â  </div>
Â  </div>

Â  <div id="bgm" class="glass" style="display:none; position:fixed; bottom:100px; left:20px; padding:15px; width:240px; z-index:10000; background:var(--panel-bg);">
Â  Â  <div style="display:flex; justify-content:space-between; margin-bottom:10px;"><b>ğŸµ BGM</b><button onclick="this.parentElement.parentElement.style.display='none'">âœ–</button></div>
Â  Â  <select id="bgmSelect" style="width:100%; padding:5px; margin-bottom:10px; display:none;"><option value="./bgm.mp3">ê¸°ë³¸</option><option value="rain">ë¹„ì˜¤ëŠ” ë‚ </option><option value="forest">ìˆ²ì†</option></select>
Â  Â  <div style="display:flex; align-items:center; gap:10px; margin-bottom:10px;"><button id="bgmToggle" style="flex:1; padding:6px; border-radius:6px; background:var(--primary); color:white; border:none;">ì¬ìƒ</button></div>
Â  Â  <input id="bgmVol" type="range" min="0" max="1" step="0.01" value="0.25" style="width:100%;">
Â  </div>

Â  <div id="timerModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.8); z-index:20000; align-items:center; justify-content:center;">
Â  Â  Â  <div class="glass" style="padding:40px; text-align:center; background:var(--panel-bg); width:300px;">
Â  Â  Â  Â  Â  <h2 style="margin:0;">â±ï¸ ì§‘ì¤‘ íƒ€ì´ë¨¸</h2>
Â  Â  Â  Â  Â  <div id="timerDisplay" style="font-size:60px; font-weight:900; margin:20px 0;">25:00</div>
Â  Â  Â  Â  Â  <div style="display:flex; gap:10px;">
Â  Â  Â  Â  Â  Â  Â  <button id="startTimerBtn" class="btn btn-primary">ì‹œì‘</button>
Â  Â  Â  Â  Â  Â  Â  <button id="stopTimerBtn" class="btn">ì¤‘ì§€</button>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <button onclick="document.getElementById('timerModal').style.display='none'" style="margin-top:20px; border:none; background:none; text-decoration:underline;">ë‹«ê¸°</button>
Â  Â  Â  </div>
Â  </div>

Â  <div id="proModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.6); align-items:center; justify-content:center; z-index:10001; backdrop-filter:blur(5px);">
Â  Â  <div class="glass" style="padding:40px; max-width:360px; width:90%; text-align:center; background:var(--panel-bg);">
Â  Â  Â  <h2 style="margin-top:0;" id="modalTitle">ğŸ‘‘ ì—…ê·¸ë ˆì´ë“œ</h2>
Â  Â  Â  <p style="color:var(--text-muted); margin-bottom:20px;">ë” ê°•ë ¥í•œ ê¸°ëŠ¥ìœ¼ë¡œ ì„±ì¥í•˜ì„¸ìš”.</p>
Â  Â  Â  <button class="btn btn-primary" onclick="alert('ê²°ì œ ê¸°ëŠ¥ ì¤€ë¹„ì¤‘!')">ì‹œì‘í•˜ê¸°</button>
Â  Â  Â  <p style="margin-top:16px; font-size:13px; cursor:pointer; color:var(--text-muted);" onclick="this.closest('#proModal').style.display='none'">ë‹«ê¸°</p>
Â  Â  </div>
Â  </div>

Â  <div id="levelUpOverlay" class="levelup-overlay" style="display:none; position: fixed; inset:0; background: rgba(0,0,0,0.85); z-index: 25000; flex-direction: column; align-items: center; justify-content: center; color: white;">
Â  Â  <div style="font-size:80px; margin-bottom:20px;">ğŸ†™</div>
Â  Â  <div style="font-size: 4rem; font-weight: 900; background: linear-gradient(to right, #ffd700, #ff8c00); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">LEVEL UP!</div>
Â  Â  <p style="font-size:1.5rem; margin-top:10px; color:#fff;">ì¶•í•˜í•©ë‹ˆë‹¤! í•œ ë‹¨ê³„ ì„±ì¥í•˜ì…¨êµ°ìš”.</p>
Â  Â  <button class="btn btn-primary" onclick="document.getElementById('levelUpOverlay').style.display='none'" style="margin-top:30px; font-size:1.2rem; padding:15px 40px; width:auto;">ê³„ì†í•˜ê¸°</button>
Â  </div>

Â  <div id="adminPanel">
Â  Â  <div class="matrix-bg"></div>
Â  Â  <button class="admin-close-x" onclick="document.getElementById('adminPanel').style.display='none'">âœ–</button>
Â  Â Â 
Â  Â  <div class="admin-shell">
Â  Â  Â  <div class="admin-left">
Â  Â  Â  Â  <div class="admin-title">ğŸ‘‘ GOD MODE</div>
Â  Â  Â  Â  <div class="admin-sub" id="adminSubtitle">SYSTEM ACCESS GRANTED</div>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div class="admin-nav">
Â  Â  Â  Â  Â  <button class="adminNavBtn active" data-pane="pane-dashboard">ğŸ“Š ëŒ€ì‹œë³´ë“œ</button>
Â  Â  Â  Â  Â  <button class="adminNavBtn" data-pane="pane-users">ğŸ‘¥ ìœ ì € ê´€ë¦¬</button>
Â  Â  Â  Â  Â  <button class="adminNavBtn" data-pane="pane-tools">ğŸ› ï¸ ì‹ ì˜ ê¶ŒëŠ¥</button>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div style="margin-top:auto; color:#666; font-size:11px;">
Â  Â  Â  Â  Â  SECURE CONNECTION ESTABLISHED<br>v2.5.0 ULTIMATE
Â  Â  Â  Â  </div>
Â  Â  Â  </div>

Â  Â  Â  <div class="admin-right">
Â  Â  Â  Â  <div id="pane-dashboard" class="admin-pane active">
Â  Â  Â  Â  Â  <h2 style="color:#fff; margin-top:0;">ì‹œìŠ¤í…œ í˜„í™©</h2>
Â  Â  Â  Â  Â  <div class="admin-cards">
Â  Â  Â  Â  Â  Â  <div class="admin-card"><div class="k">TOTAL USERS</div><div class="v" id="dashTotal">0</div></div>
Â  Â  Â  Â  Â  Â  <div class="admin-card"><div class="k">PRO MEMBERS</div><div class="v" id="dashPro">0</div></div>
Â  Â  Â  Â  Â  Â  <div class="admin-card"><div class="k">ACTIVE (7D)</div><div class="v" id="dashActive">0</div></div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  <h4 style="color:#aaa; margin-bottom:5px;">USER TIER DISTRIBUTION</h4>
Â  Â  Â  Â  Â  <div class="chart-container" id="tierChart"></div>
Â  Â  Â  Â  Â  <div class="chart-legend">
Â  Â  Â  Â  Â  Â  Â <span id="legendFree"><span class="dot" style="background:#444"></span>FREE</span>
Â  Â  Â  Â  Â  Â  Â <span id="legendPro"><span class="dot" style="background:#6366f1"></span>PRO</span>
Â  Â  Â  Â  Â  Â  Â <span id="legendMaster"><span class="dot" style="background:#ffd700"></span>MASTER</span>
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <h3 style="color:#0f0; margin-top:30px;">ğŸ“Ÿ THE MATRIX LOG</h3>
Â  Â  Â  Â  Â  <div id="matrixLog" class="matrix-terminal">
Â  Â  Â  Â  Â  Â  <div class="log-line"><span>[SYSTEM]</span> Initializing global surveillance...</div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div id="pane-users" class="admin-pane">
Â  Â  Â  Â  Â  <h2 style="color:#fff; margin-top:0;">ìœ ì € ê´€ë¦¬</h2>
Â  Â  Â  Â  Â  <div style="display:flex; gap:10px; margin-bottom:20px;">
Â  Â  Â  Â  Â  Â  <input id="adminSearch" placeholder="ì´ë©”ì¼ ê²€ìƒ‰..." style="flex:1; background:#222; border:1px solid #444; color:#fff;">
Â  Â  Â  Â  Â  Â  <button id="refreshAdminBtn" class="btn" style="background:#333; color:#fff; border:1px solid #555;">ìƒˆë¡œê³ ì¹¨</button>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div id="admUserList" style="display:grid; gap:10px;"></div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div id="pane-tools" class="admin-pane">
Â  Â  Â  Â  Â  <h2 style="color:#fff; margin-top:0;">ì‹ ì˜ ê¶ŒëŠ¥ (God Tools)</h2>
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  <div class="admin-cards" style="grid-template-columns: 1fr 1fr;">
Â  Â  Â  Â  Â  Â  <div class="admin-card">
Â  Â  Â  Â  Â  Â  Â  <div class="k">ğŸ’° MASS GIFT</div>
Â  Â  Â  Â  Â  Â  Â  <p style="color:#888; font-size:12px; margin-bottom:15px;">ëª¨ë“  ìœ ì €ì—ê²Œ 100 ì½”ì¸ì„ ì„ ë¬¼í•©ë‹ˆë‹¤.</p>
Â  Â  Â  Â  Â  Â  Â  <button onclick="godModeGift()" class="btn" style="width:100%; background:#ffd700; color:#000; border:none; font-weight:900;">ì „ì²´ ì½”ì¸ ë°œì†¡</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div class="admin-card">
Â  Â  Â  Â  Â  Â  Â  <div class="k">ğŸ“¢ EMERGENCY BROADCAST</div>
Â  Â  Â  Â  Â  Â  Â  <p style="color:#888; font-size:12px; margin-bottom:10px;">ëª¨ë“  ìœ ì € í™”ë©´ì— ê¸´ê¸‰ ê³µì§€ë¥¼ ë„ì›ë‹ˆë‹¤.</p>
Â  Â  Â  Â  Â  Â  Â  <div style="display:flex; gap:5px;">
Â  Â  Â  Â  Â  Â  Â  Â  <input id="broadcastInput" placeholder="ê³µì§€ ë‚´ìš© ì…ë ¥" style="background:#222; border:1px solid #444; color:#fff; width:100%;">
Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="godModeBroadcast()" class="btn" style="background:#ef4444; color:#fff; border:none; width:auto;">ì „ì†¡</button>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <div class="admin-card" style="margin-top:20px;">
Â  Â  Â  Â  Â  Â  <div class="k">ğŸ“‚ DATA BACKUP</div>
Â  Â  Â  Â  Â  Â  <p style="color:#888; font-size:12px;">ìœ ì € ë°ì´í„°ë¥¼ CSVë¡œ ì¶”ì¶œí•©ë‹ˆë‹¤.</p>
Â  Â  Â  Â  Â  Â  <button onclick="exportCSV()" class="btn" style="background:#333; color:#fff; border:1px solid #555;">CSV ë‹¤ìš´ë¡œë“œ</button>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  <button onclick="document.getElementById('adminPanel').style.display='none'" class="btn" style="margin-top:30px; background:transparent; color:#ef4444; border:1px solid #ef4444; width:100%;">GOD MODE ì¢…ë£Œ</button>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  </div>
Â  </div>

Â  <audio id="bgmAudio" src="./bgm.mp3" preload="auto" loop></audio>

<script type="module">
Â  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
Â  import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged, signOut, getIdTokenResult, sendPasswordResetEmail, sendEmailVerification } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
Â  import { getFirestore, doc, setDoc, getDoc, collection, getDocs, updateDoc, onSnapshot, addDoc, query, orderBy, limit, arrayUnion, deleteDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

Â  const firebaseConfig = {
Â  Â  apiKey: "AIzaSyAIaroNs2VsMamnnNJV1cP9LdXqIDhl3Ig",
Â  Â  authDomain: "giiiddd-36340523-3f595.firebaseapp.com",
Â  Â  projectId: "giiiddd-36340523-3f595",
Â  Â  storageBucket: "giiiddd-36340523-3f595.firebasestorage.app",
Â  Â  messagingSenderId: "698901018936",
Â  Â  appId: "1:698901018936:web:2fb12a7a03cbd844c1e9cd"
Â  };

Â  const app = initializeApp(firebaseConfig);
Â  const auth = getAuth(app);
Â  const db = getFirestore(app);

Â  // ğŸš¨ ê´€ë¦¬ì ì´ë©”ì¼ ì„¤ì •
Â  const ADMIN_EMAILS = ["test@gmail.com"];

Â  // ğŸ”Š Audio Manager
Â  const sfx = {
Â  Â  Â  click: new Audio("https://cdn.pixabay.com/download/audio/2022/03/15/audio_c8c8a73467.mp3?filename=click-124467.mp3"),
Â  Â  Â  success: new Audio("https://cdn.pixabay.com/download/audio/2021/08/04/audio_bb630cc098.mp3?filename=success-1-6297.mp3"),
Â  Â  Â  levelUp: new Audio("https://cdn.pixabay.com/download/audio/2022/03/15/audio_7368884964.mp3?filename=success-fanfare-trumpets-6185.mp3"),
Â  Â  Â  adminOpen: new Audio("https://cdn.pixabay.com/download/audio/2022/03/24/audio_03e0545939.mp3?filename=sci-fi-click-903.mp3"),
Â  Â  Â  play: (name) => { try { sfx[name].currentTime=0; sfx[name].play(); } catch(e){} }
Â  };

Â  const STICKERS = ["ğŸ","ğŸ’Š","ğŸ“š","ğŸ¸","ğŸ’","ğŸ‘‘","ğŸš€","ğŸ¦„","ğŸ¦–","ğŸ•","ğŸŒˆ","ğŸ”¥","ğŸ’§","â­","ğŸ€","ğŸ„"];
Â  const themeData = {
Â  Â  survival: ["ğŸ›Œ ë°¤ 11ì‹œ í° ë„ê¸°", "ğŸ’§ ê³µë³µ ë¬¼ í•œ ì”", "ğŸ’Š ì˜ì–‘ì œ ì±™ê²¨ë¨¹ê¸°", "ğŸ¢ ê±°ë¶ëª© ìŠ¤íŠ¸ë ˆì¹­", "ğŸ‘ï¸ ë¨¼ ì‚° ë³´ê¸°", "ğŸ§¹ ì±…ìƒ ìœ„ ë¦¬ì…‹"],
Â  Â  godsaeng: ["ğŸ“… ì£¼ê°„ ê³„íš", "ğŸ›ï¸ ì´ë¶ˆ ì •ë¦¬", "ğŸ’° ê°€ê³„ë¶€", "ğŸ“š ë…ì„œ 2p", "ğŸ—£ï¸ ì˜ë‹¨ì–´ 1ê°œ", "ğŸ“ ê°ì‚¬ì¼ê¸°"],
Â  Â  detox: ["ğŸ“ ì†ê¸°ë¡", "ğŸ“µ ê¸°ìƒí›„ ë…¸í°", "ğŸ½ï¸ ë°¥ë¨¹ì„ë•Œ í°X", "ğŸ§ ì´ì–´í° ë¹¼ê¸°", "ğŸ§˜ ëª…ìƒ 5ë¶„"],
Â  Â  custom: []Â 
Â  };
Â Â 
Â  // Rotating Recommendation
Â  const recommendations = [
Â  Â  Â  { t: "ğŸš‘ ìƒì¡´ ì²´ë ¥ íŒ©", d: 'ì§ì¥ì¸ì„ ìœ„í•œ "ì£½ì§€ ì•Šìœ¼ë ¤ê³  í•˜ëŠ” ìš´ë™"' },
Â  Â  Â  { t: "âœ¨ ê°“ìƒ ì…ë¬¸ íŒ©", d: 'ì„±ê³µ ë£¨í‹´ì„ 2ë¶„ì§œë¦¬ë¡œ ìª¼ê°œê¸°' },
Â  Â  Â  { t: "ğŸ§˜ ë””í†¡ìŠ¤ íë§ íŒ©", d: 'ìŠ¤ë§ˆíŠ¸í° ë‚´ë ¤ë†“ê³  ë‡Œ íœ´ì‹í•˜ê¸°' }
Â  ];
Â  let recIdx = 0;
Â  setInterval(() => {
Â  Â  Â  const card = document.getElementById('heroRecommendCard');
Â  Â  Â  if(card) {
Â  Â  Â  Â  Â  recIdx = (recIdx + 1) % recommendations.length;
Â  Â  Â  Â  Â  card.style.opacity = 0;
Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  card.innerHTML = `<div><b>${recommendations[recIdx].t}</b></div><span style="font-size:12px; color:var(--text-muted)">${recommendations[recIdx].d}</span>`;
Â  Â  Â  Â  Â  Â  Â  card.style.opacity = 1;
Â  Â  Â  Â  Â  }, 500);
Â  Â  Â  }
Â  }, 4000);

Â  // Workout Challenge
Â  window.selectWorkoutTab = (type) => {
Â  Â  Â  sfx.play('click');
Â  Â  Â  document.querySelectorAll('.w-tab').forEach(t => t.classList.remove('active'));
Â  Â  Â  event.target.classList.add('active');
Â  Â  Â  document.getElementById('startWorkoutBtn').dataset.type = type;
Â  Â  Â  document.getElementById('workoutResult').innerHTML = '<span class="wd-main">â“</span><div class="wd-sub">ì¢…ëª© ì„ íƒ í›„ ë¯¸ì…˜ ë½‘ê¸°!</div>';
Â  Â  Â  document.getElementById('completeWorkoutBtn').style.display = 'none';
Â  Â  Â  document.getElementById('startWorkoutBtn').style.display = 'inline-block';
Â  }

Â  document.getElementById("startWorkoutBtn").onclick = () => {
Â  Â  Â  sfx.play('click');
Â  Â  Â  const type = document.getElementById('startWorkoutBtn').dataset.type;
Â  Â  Â  if(!type) return alert("ì¢…ëª©ì„ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”!");
Â  Â  Â Â 
Â  Â  Â  const res = document.getElementById("workoutResult");
Â  Â  Â  res.innerHTML = '<span class="workout-anim">...ë‘êµ¬ë‘êµ¬...</span>';
Â  Â  Â Â 
Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  let mainText = "";
Â  Â  Â  Â  Â  let subText = "í™”ì´íŒ…!";
Â  Â  Â  Â  Â  if(type === 'walk') {
Â  Â  Â  Â  Â  Â  Â  const times = [30, 60, 90, 120];
Â  Â  Â  Â  Â  Â  Â  const t = times[Math.floor(Math.random()*times.length)];
Â  Â  Â  Â  Â  Â  Â  mainText = `ğŸš¶ ê±·ê¸° ${t}ë¶„`;
Â  Â  Â  Â  Â  Â  Â  subText = "ê°€ë³ê²Œ ì‹œì‘í•´ë³´ì„¸ìš”!";
Â  Â  Â  Â  Â  } else if(type === 'run') {
Â  Â  Â  Â  Â  Â  Â  const times = [20, 30, 40, 60];
Â  Â  Â  Â  Â  Â  Â  const t = times[Math.floor(Math.random()*times.length)];
Â  Â  Â  Â  Â  Â  Â  mainText = `ğŸƒ ë‹¬ë¦¬ê¸° ${t}ë¶„`;
Â  Â  Â  Â  Â  Â  Â  subText = "ì‹¬ì¥ì´ í„°ì§ˆ ë•Œê¹Œì§€!";
Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  const routines = ["ìŠ¤ì¿¼íŠ¸ 100ê°œ", "í‘¸ì‰¬ì—… 50ê°œ + í”Œë­í¬ 3ë¶„", "ë“± ìš´ë™ 5ì„¸íŠ¸", "í•˜ì²´ ì§‘ì¤‘ íƒ€ê²©", "ë²„í”¼ 50íšŒ"];
Â  Â  Â  Â  Â  Â  Â  mainText = `ğŸ‹ï¸ ${routines[Math.floor(Math.random()*routines.length)]}`;
Â  Â  Â  Â  Â  Â  Â  subText = "ê·¼ì„±ì¥ ê°€ì¦ˆì•„!";
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  res.innerHTML = `<div class="wd-main">${mainText}</div><div class="wd-sub">${subText}</div>`;
Â  Â  Â  Â  Â  document.getElementById('startWorkoutBtn').style.display = 'none';
Â  Â  Â  Â  Â  document.getElementById('completeWorkoutBtn').style.display = 'inline-block';
Â  Â  Â  }, 1000);
Â  };

Â  document.getElementById("completeWorkoutBtn").onclick = async () => {
Â  Â  Â  sfx.play('success');
Â  Â  Â  const user = auth.currentUser;
Â  Â  Â  if(!user) return;
Â  Â  Â  const ref = doc(db,"users",user.uid);
Â  Â  Â  const snap = await getDoc(ref);
Â  Â  Â  let coins = snap.data().coins || 0;
Â  Â  Â  coins += 3;
Â  Â  Â  await updateDoc(ref, { coins });
Â  Â  Â  alert("ğŸ”¥ ì±Œë¦°ì§€ ì™„ë£Œ! ì½”ì¸ 3ê°œ íšë“!");
Â  Â  Â  updateLevelUI(user.uid);
Â  Â  Â  confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
Â  Â  Â  document.getElementById('completeWorkoutBtn').style.display = 'none';
Â  Â  Â  document.getElementById('startWorkoutBtn').style.display = 'inline-block';
Â  Â  Â  document.getElementById('workoutResult').innerHTML = '<div class="wd-main">âœ… ì™„ë£Œ</div><div class="wd-sub">ë‚´ì¼ ë˜ ë„ì „í•˜ì„¸ìš”!</div>';
Â  };

Â  function dateKeyFromOffset(n) { const d = new Date(); d.setDate(d.getDate()-n); return d.toISOString().slice(0,10); }
Â  async function getConsecutiveStreak(uid) {
Â  Â  let c = 0, d = new Date();
Â  Â  while(true) {
Â  Â  Â  if(!(await getDoc(doc(db,"users",uid,"habits",d.toISOString().slice(0,10)))).exists()) break;
Â  Â  Â  c++; d.setDate(d.getDate()-1);
Â  Â  }
Â  Â  return c;
Â  }

Â  async function updateLevelUI(uid) {
Â  Â  const d = (await getDoc(doc(db,"users",uid))).data() || {};
Â  Â  const lvl = d.level||1;
Â  Â  document.getElementById("levelBadge").innerText = `Lv.${lvl}`;
Â  Â  document.getElementById("xpText").innerText = `${d.xp||0} / 100 XP`;
Â  Â  document.getElementById("xpBar").style.width = `${(d.xp||0)}%`;
Â  Â  document.getElementById("coinDisplay").style.display = 'flex';
Â  Â  document.getElementById("coinCount").innerText = d.coins||0;
Â  Â Â 
Â  Â  // Title Rank System
Â  Â  let title = "ì…ë¬¸ì";
Â  Â  if(lvl >= 5) title = "ìˆ™ë ¨ì";
Â  Â  if(lvl >= 10) title = "ì „ë¬¸ê°€";
Â  Â  if(lvl >= 20) title = "ìŠµê´€ì˜ ì‹ ";
Â  Â  document.getElementById("welcome").innerHTML = `ğŸ‘‹ ${d.email.split('@')[0]} <span style="font-size:12px; color:var(--primary);">[${title}]</span>`;

Â  Â  const petC = document.getElementById("petContainer");
Â  Â  if(d.isMaster) petC.classList.add("aura-effect");
Â  Â  else petC.classList.remove("aura-effect");

Â  Â  let emoji = "ğŸ¥š";
Â  Â  if(lvl>=16) emoji="ğŸ‘‘"; else if(lvl>=8) emoji="ğŸ²"; else if(lvl>=4) emoji="ğŸ¥"; else if(lvl>=2) emoji="ğŸ£";
Â  Â  document.getElementById("petEmoji").innerText = emoji;
Â  }

Â  // --- Sticker Logic ---
Â  let isDeleteMode = false;
Â  const trashBtn = document.getElementById("trashModeBtn");
Â  trashBtn.onclick = () => {
Â  Â  Â  sfx.play('click');
Â  Â  Â  isDeleteMode = !isDeleteMode;
Â  Â  Â  trashBtn.style.background = isDeleteMode ? "#ef4444" : "var(--accent)";
Â  Â  Â  document.body.classList.toggle("is-delete-mode");
Â  Â  Â  alert(isDeleteMode ? "ğŸ—‘ï¸ ì‚­ì œ ëª¨ë“œ ON: ìŠ¤í‹°ì»¤ë¥¼ í´ë¦­í•´ì„œ ì§€ìš°ì„¸ìš”." : "âœ¨ ì‚­ì œ ëª¨ë“œ OFF");
Â  };

Â  async function loadInventory(uid) {
Â  Â  Â  const d = (await getDoc(doc(db,"users",uid))).data() || {};
Â  Â  Â  const list = document.getElementById("inventoryList"); list.innerHTML = "";
Â  Â  Â  (d.inventory||[]).forEach(s => {
Â  Â  Â  Â  Â  const div = document.createElement("div"); div.innerText = s;
Â  Â  Â  Â  Â  div.style.cssText = "font-size:30px; cursor:grab; background:white; border-radius:8px; text-align:center;";
Â  Â  Â  Â  Â  div.onmousedown = (e) => startDrag(e,s,uid,true);
Â  Â  Â  Â  Â  div.ontouchstart = (e) => startDrag(e,s,uid,true);
Â  Â  Â  Â  Â  list.appendChild(div);
Â  Â  Â  });
Â  }

Â  async function loadPlacedStickers(uid) {
Â  Â  Â  const d = (await getDoc(doc(db,"users",uid))).data() || {};
Â  Â  Â  const layer = document.getElementById("stickerLayer"); layer.innerHTML = "";
Â  Â  Â  (d.placedStickers||[]).forEach(s => createStickerEl(s, uid));
Â  }

Â  function createStickerEl(data, uid) {
Â  Â  Â  const el = document.createElement("div"); el.className = "sticker"; el.innerText = data.char;
Â  Â  Â  el.style.left = data.x+"%"; el.style.top = data.y+"%"; el.id = data.id;
Â  Â  Â Â 
Â  Â  Â  const dragStart = (e) => {
Â  Â  Â  Â  Â  if(isDeleteMode) return;Â 
Â  Â  Â  Â  Â  startDrag(e, el, uid, false);Â 
Â  Â  Â  };
Â  Â  Â  el.addEventListener('mousedown', dragStart);
Â  Â  Â  el.addEventListener('touchstart', dragStart, {passive:false});
Â  Â  Â Â 
Â  Â  Â  el.addEventListener('click', async (e) => {
Â  Â  Â  Â  Â  if(!isDeleteMode) return;
Â  Â  Â  Â  Â  e.stopPropagation(); e.preventDefault();
Â  Â  Â  Â  Â  if(confirm("ì´ ìŠ¤í‹°ì»¤ë¥¼ ì‚­ì œí• ê¹Œìš”?")) {
Â  Â  Â  Â  Â  Â  Â  el.remove();
Â  Â  Â  Â  Â  Â  Â  const r = doc(db,"users",uid);
Â  Â  Â  Â  Â  Â  Â  const p = (await getDoc(r)).data().placedStickers || [];
Â  Â  Â  Â  Â  Â  Â  await updateDoc(r, { placedStickers: p.filter(s => s.id !== data.id) });
Â  Â  Â  Â  Â  }
Â  Â  Â  });
Â  Â  Â  document.getElementById("stickerLayer").appendChild(el);
Â  }

Â  let dragCtx = null;
Â  function startDrag(e, target, uid, isNew) {
Â  Â  Â  if(isDeleteMode) return;
Â  Â  Â  e.preventDefault();
Â  Â  Â  const el = isNew ? document.createElement("div") : target;
Â  Â  Â  if(isNew) { el.className = "sticker"; el.innerText = target; el.style.pointerEvents="none"; document.body.appendChild(el); }
Â  Â  Â Â 
Â  Â  Â  dragCtx = { el, isNew, char: isNew?target:null, uid };
Â  Â  Â  const cx = e.clientX||e.touches[0].clientX;
Â  Â  Â  const cy = e.clientY||e.touches[0].clientY;
Â  Â  Â Â 
Â  Â  Â  if(!isNew) {
Â  Â  Â  Â  Â  const r = el.getBoundingClientRect();
Â  Â  Â  Â  Â  dragCtx.ox = cx - r.left; dragCtx.oy = cy - r.top;
Â  Â  Â  Â  Â  el.style.zIndex = 1000;
Â  Â  Â  } else {
Â  Â  Â  Â  Â  el.style.left = (cx-20)+"px"; el.style.top = (cy-20)+"px";
Â  Â  Â  }

Â  Â  Â  document.addEventListener('mousemove', onMove); document.addEventListener('mouseup', onEnd);
Â  Â  Â  document.addEventListener('touchmove', onMove, {passive:false}); document.addEventListener('touchend', onEnd);
Â  }

Â  function onMove(e) {
Â  Â  Â  if(!dragCtx) return;
Â  Â  Â  e.preventDefault();
Â  Â  Â  const cx = e.clientX||e.touches[0].clientX; const cy = e.clientY||e.touches[0].clientY;
Â  Â  Â  if(dragCtx.isNew) { dragCtx.el.style.left=(cx-20)+"px"; dragCtx.el.style.top=(cy-20)+"px"; }
Â  Â  Â  else { dragCtx.el.style.left=(cx-dragCtx.ox)+"px"; dragCtx.el.style.top=(cy-dragCtx.oy)+"px"; }
Â  }

Â  async function onEnd(e) {
Â  Â  Â  document.removeEventListener('mousemove', onMove); document.removeEventListener('mouseup', onEnd);
Â  Â  Â  document.removeEventListener('touchmove', onMove); document.removeEventListener('touchend', onEnd);
Â  Â  Â  if(!dragCtx) return;

Â  Â  Â  const layer = document.getElementById("stickerLayer");
Â  Â  Â  const r = layer.getBoundingClientRect();
Â  Â  Â  const cx = e.clientX||(e.changedTouches?e.changedTouches[0].clientX:0);
Â  Â  Â  const cy = e.clientY||(e.changedTouches?e.changedTouches[0].clientY:0);
Â  Â  Â Â 
Â  Â  Â  let x, y;
Â  Â  Â  if(dragCtx.isNew) {
Â  Â  Â  Â  Â  x = ((cx - r.left)/r.width)*100; y = ((cy - r.top)/r.height)*100;
Â  Â  Â  Â  Â  dragCtx.el.remove();
Â  Â  Â  } else {
Â  Â  Â  Â  Â  const er = dragCtx.el.getBoundingClientRect();
Â  Â  Â  Â  Â  x = ((er.left - r.left)/r.width)*100; y = ((er.top - r.top)/r.height)*100;
Â  Â  Â  Â  Â  dragCtx.el.style.zIndex="";
Â  Â  Â  }

Â  Â  Â  const ref = doc(db,"users",dragCtx.uid);
Â  Â  Â  const placed = (await getDoc(ref)).data().placedStickers || [];
Â  Â  Â Â 
Â  Â  Â  if(dragCtx.isNew) {
Â  Â  Â  Â  Â  const s = { id: Date.now().toString(), char: dragCtx.char, x, y };
Â  Â  Â  Â  Â  placed.push(s); createStickerEl(s, dragCtx.uid);
Â  Â  Â  } else {
Â  Â  Â  Â  Â  const i = placed.findIndex(s => s.id === dragCtx.el.id);
Â  Â  Â  Â  Â  if(i>-1) { placed[i].x=x; placed[i].y=y; dragCtx.el.style.left=x+"%"; dragCtx.el.style.top=y+"%"; }
Â  Â  Â  }
Â  Â  Â  await updateDoc(ref, { placedStickers: placed });
Â  Â  Â  dragCtx = null;
Â  }

Â  window.selectTheme = async (el, type) => {
Â  Â  Â  sfx.play('click');
Â  Â  Â  const user = auth.currentUser; if(!user) return alert("ë¡œê·¸ì¸ í•„ìš”");
Â  Â  Â  const input = document.getElementById("habitName");
Â  Â  Â  document.querySelectorAll('.theme-tag').forEach(t=>t.classList.remove('active'));
Â  Â  Â Â 
Â  Â  Â  if(type==='custom') {
Â  Â  Â  Â  Â  const t = await getIdTokenResult(user);
Â  Â  Â  Â  Â  if(!t.claims.pro && !t.claims.admin) return alert("ğŸ”’ PRO ì „ìš©");
Â  Â  Â  Â  Â  input.readOnly=false; input.value=""; input.focus();
Â  Â  Â  } else {
Â  Â  Â  Â  Â  input.readOnly=true;
Â  Â  Â  Â  Â  const pool = themeData[type];
Â  Â  Â  Â  Â  input.value = pool[Math.floor(Math.random()*pool.length)]; // ğŸ”¥ Random
Â  Â  Â  }
Â  Â  Â  if(el) el.classList.add('active');
Â  };

Â  window.showProModal = (type) => {
Â  Â  Â  document.getElementById("modalTitle").innerText = `ğŸ‘‘ ${type} ì—…ê·¸ë ˆì´ë“œ`;
Â  Â  Â  document.getElementById("proModal").style.display = 'flex';
Â  };

Â  window.changeTheme = async (c) => {
Â  Â  Â  const user = auth.currentUser; if(!user) return;
Â  Â  Â  const d = (await getDoc(doc(db,"users",user.uid))).data();
Â  Â  Â  if(!d.isUltra && !d.isMaster && user.email!=="test@gmail.com") return alert("ğŸ’ ULTRA ì „ìš©");
Â  Â  Â Â 
Â  Â  Â  let p, s;
Â  Â  Â  if(c==='blue') { p='#3b82f6'; s='#60a5fa'; }
Â  Â  Â  else if(c==='pink') { p='#ec4899'; s='#f472b6'; }
Â  Â  Â  else if(c==='gold') { p='#d97706'; s='#fbbf24'; }
Â  Â  Â  else { p='#6366f1'; s='#a855f7'; }
Â  Â  Â  document.documentElement.style.setProperty('--primary', p);
Â  Â  Â  document.documentElement.style.setProperty('--secondary', s);
Â  Â  Â  document.querySelector('.blob-1').style.background = s;
Â  Â  Â  document.querySelector('.blob-2').style.background = p;
Â  };

Â  async function loadStats(uid) {
Â  Â  Â  const snap = await getDocs(collection(db,"users",uid,"habits"));
Â  Â  Â  let successCount = 0;
Â  Â  Â  snap.forEach(doc => {
Â  Â  Â  Â  Â  if(doc.data().done) successCount++;
Â  Â  Â  });
Â  Â  Â  safeText("totalDays", `ì´ ëˆ„ì  ì„±ê³µ: ${successCount}ì¼`);
Â  }

Â  // Memo Saving
Â  document.getElementById("saveMemoBtn").onclick = async () => {
Â  Â  Â  sfx.play('click');
Â  Â  Â  const user = auth.currentUser; if(!user) return;
Â  Â  Â  const memo = document.getElementById("dailyMemo").value;
Â  Â  Â  if(!memo.trim()) return alert("ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”");
Â  Â  Â Â 
Â  Â  Â  const today = dateKeyFromOffset(0);
Â  Â  Â  await setDoc(doc(db,"users",user.uid,"habits",today), { memo: memo }, { merge: true });
Â  Â  Â  alert("âœ… ë©”ëª¨ ì €ì¥ ì™„ë£Œ!");
Â  Â  Â  renderMemoHistory(user.uid);
Â  };

Â  async function renderMemoHistory(uid) {
Â  Â  Â  const listDiv = document.getElementById("memoHistoryList");
Â  Â  Â  listDiv.innerHTML = "ë¡œë”© ì¤‘...";
Â  Â  Â Â 
Â  Â  Â  const snap = await getDocs(collection(db,"users",uid,"habits"));
Â  Â  Â  let memos = [];
Â  Â  Â  snap.forEach(doc => {
Â  Â  Â  Â  Â  const d = doc.data();
Â  Â  Â  Â  Â  if(d.memo) memos.push({date: doc.id, text: d.memo});
Â  Â  Â  });
Â  Â  Â Â 
Â  Â  Â  memos.sort((a,b) => new Date(b.date) - new Date(a.date));
Â  Â  Â Â 
Â  Â  Â  if(memos.length === 0) {
Â  Â  Â  Â  Â  listDiv.innerHTML = '<div style="text-align:center; padding:10px; color:var(--text-muted); font-size:13px;">ê¸°ë¡ëœ ë©”ëª¨ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
Â  Â  Â  Â  Â  return;
Â  Â  Â  }
Â  Â  Â Â 
Â  Â  Â  listDiv.innerHTML = "";
Â  Â  Â  memos.forEach(m => {
Â  Â  Â  Â  Â  const div = document.createElement("div");
Â  Â  Â  Â  Â  div.className = "memo-item";
Â  Â  Â  Â  Â  div.innerHTML = `<div class="memo-date">${m.date}</div><div>${m.text}</div>`;
Â  Â  Â  Â  Â  listDiv.appendChild(div);
Â  Â  Â  });
Â  }

Â  // Global Cheer
Â  document.getElementById("globalCheerBtn").onclick = async () => {
Â  Â  Â  sfx.play('success');
Â  Â  Â  const user = auth.currentUser;
Â  Â  Â  if(!user) return;
Â  Â  Â  // Add cheer log
Â  Â  Â  await addDoc(collection(db, "global_logs"), {
Â  Â  Â  Â  Â  msg: "CHEER",
Â  Â  Â  Â  Â  type: "cheer",
Â  Â  Â  Â  Â  timestamp: new Date()
Â  Â  Â  });
Â  Â  Â  // Visual feedback for self
Â  Â  Â  triggerHearts();
Â  };

Â  function triggerHearts() {
Â  Â  Â  for(let i=0; i<5; i++) {
Â  Â  Â  Â  Â  const heart = document.createElement("div");
Â  Â  Â  Â  Â  heart.innerText = "ğŸ’–";
Â  Â  Â  Â  Â  heart.className = "cheer-heart";
Â  Â  Â  Â  Â  heart.style.left = Math.random() * 100 + "vw";
Â  Â  Â  Â  Â  heart.style.bottom = "-20px";
Â  Â  Â  Â  Â  heart.style.animationDuration = (3 + Math.random()) + "s";
Â  Â  Â  Â  Â  document.body.appendChild(heart);
Â  Â  Â  Â  Â  setTimeout(() => heart.remove(), 4000);
Â  Â  Â  }
Â  }

Â  // Auth State
Â  onAuthStateChanged(auth, async user => {
Â  Â  Â  if(!user) {
Â  Â  Â  Â  Â  document.getElementById("auth").style.display='block';
Â  Â  Â  Â  Â  document.getElementById("dashboardLayout").style.display='none';
Â  Â  Â  Â  Â  document.getElementById("coinDisplay").style.display = 'none';
Â  Â  Â  Â  Â  ['adminOpenBtn','rankOpenBtn','shopOpenBtn','trashModeBtn','bgmOpenBtn','themeBtn'].forEach(id=>document.getElementById(id).style.display='none');
Â  Â  Â  Â  Â  return;
Â  Â  Â  }
Â  Â  Â Â 
Â  Â  Â  const isAdmin = ADMIN_EMAILS.includes(user.email || "");
Â  Â  Â  if(!user.emailVerified && !isAdmin) { alert("ì¸ì¦ í•„ìš”"); await signOut(auth); return; }

Â  Â  Â  document.getElementById("auth").style.display='none';
Â  Â  Â  document.getElementById("dashboardLayout").style.display='flex';
Â  Â  Â Â 
Â  Â  Â  ['rankOpenBtn','shopOpenBtn','trashModeBtn','bgmOpenBtn'].forEach(id=>document.getElementById(id).style.display='block');
Â  Â  Â Â 
Â  Â  Â  const userRef = doc(db,"users",user.uid);
Â  Â  Â  let snap = await getDoc(userRef);
Â  Â  Â  if(!snap.exists()){
Â  Â  Â  Â  Â  await setDoc(userRef, {
Â  Â  Â  Â  Â  Â  Â  email: user.email, isPro: false, isBanned: false, streakProtectionLeft: 2,Â 
Â  Â  Â  Â  Â  Â  Â  createdAt: new Date().toISOString()
Â  Â  Â  Â  Â  }, {merge:true});
Â  Â  Â  Â  Â  snap = await getDoc(userRef);
Â  Â  Â  }
Â  Â  Â Â 
Â  Â  Â  if(snap.data().isBanned){ alert("ì°¨ë‹¨ëœ ê³„ì •ì…ë‹ˆë‹¤."); await signOut(auth); return; }

Â  Â  Â  let { isPro, isUltra, isMaster } = snap.data() || {};
Â  Â  Â Â 
Â  Â  Â  if(isAdmin) {Â 
Â  Â  Â  Â  Â  isPro=true; isUltra=true; isMaster=true;Â 
Â  Â  Â  Â  Â  document.getElementById("adminOpenBtn").style.display='block';Â 
Â  Â  Â  Â  Â  subscribeToGlobalLogs(); // Start Matrix/Ticker Log
Â  Â  Â  } else {
Â  Â  Â  Â  Â  // Normal users subscribe for Ticker/Hearts only
Â  Â  Â  Â  Â  subscribeToGlobalLogs(true);
Â  Â  Â  }

Â  Â  Â  // Listen to Broadcasts
Â  Â  Â  subscribeToBroadcast();

Â  Â  Â  if(isUltra || isMaster) {
Â  Â  Â  Â  Â  document.getElementById("themeBtn").style.display='block';
Â  Â  Â  Â  Â  document.getElementById("bgmSelect").style.display='block';
Â  Â  Â  }
Â  Â  Â  if(isMaster) {
Â  Â  Â  Â  Â  document.getElementById("workoutSidePanel").style.display='block';
Â  Â  Â  Â  Â  document.getElementById("timerBtn").style.display='block';
Â  Â  Â  } else {
Â  Â  Â  Â  Â  document.getElementById("workoutSidePanel").style.display='none';
Â  Â  Â  Â  Â  document.getElementById("timerBtn").style.display='none';
Â  Â  Â  }

Â  Â  Â  // Memo UI
Â  Â  Â  document.getElementById("memoPanel").style.display = 'flex';
Â  Â  Â  document.getElementById("memoHistoryPanel").style.display = 'flex';
Â  Â  Â  if(isPro || isUltra || isMaster) {
Â  Â  Â  Â  Â  document.getElementById("memoLocked").style.display='none';
Â  Â  Â  Â  Â  const today = dateKeyFromOffset(0);
Â  Â  Â  Â  Â  const s = await getDoc(doc(db,"users",user.uid,"habits",today));
Â  Â  Â  Â  Â  if(s.exists() && s.data().memo) document.getElementById("dailyMemo").value = s.data().memo;
Â  Â  Â  Â  Â  renderMemoHistory(user.uid);
Â  Â  Â  } else {
Â  Â  Â  Â  Â  document.getElementById("memoLocked").style.display='flex';
Â  Â  Â  Â  Â  document.getElementById("memoHistoryPanel").style.display='none';
Â  Â  Â  }

Â  Â  Â  if(isPro||isUltra||isMaster) {
Â  Â  Â  Â  Â  document.getElementById("stats").style.display='block';
Â  Â  Â  Â  Â  safeText("status", isMaster?"ğŸ‘‘ MASTER":isUltra?"ğŸ’ ULTRA":"ğŸŒŸ PRO");
Â  Â  Â  Â  Â  loadStats(user.uid);
Â  Â  Â  } else {
Â  Â  Â  Â  Â  safeText("status", "ğŸŒ± ë¬´ë£Œ íšŒì›");
Â  Â  Â  }

Â  Â  Â  updateLevelUI(user.uid);
Â  Â  Â  loadPlacedStickers(user.uid);
Â  Â  Â  const streak = await getConsecutiveStreak(user.uid);
Â  Â  Â  updateTierUI(streak);
Â  Â  Â  renderCalendar(user.uid, (isPro||isUltra||isMaster));
Â  Â  Â Â 
Â  Â  Â  // Heatmap
Â  Â  Â  const grid=document.getElementById("heatmapGrid"); grid.innerHTML="";
Â  Â  Â  for(let i=19; i>=0; i--) {
Â  Â  Â  Â  Â  const d = dateKeyFromOffset(i);
Â  Â  Â  Â  Â  const div=document.createElement("div"); div.className="grass"; div.title=d;
Â  Â  Â  Â  Â  if((await getDoc(doc(db,"users",user.uid,"habits",d))).exists()) div.classList.add("active");
Â  Â  Â  Â  Â  grid.appendChild(div);
Â  Â  Â  }
Â  });

Â  function updateTierUI(streak) {
Â  Â  Â  const el = document.getElementById("tierBadge");
Â  Â  Â  if(el) {
Â  Â  Â  Â  Â  el.style.display = 'block';
Â  Â  Â  Â  Â  const txt = document.getElementById("streakCount");
Â  Â  Â  Â  Â  if(streak >= 3) {
Â  Â  Â  Â  Â  Â  Â  txt.innerHTML = `ğŸ”¥ <span class="fire-anim">ğŸ”¥</span> ${streak}ì¼ ì—°ì† ì„±ê³µ!`;
Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  txt.innerHTML = `ğŸ”¥ ${streak}ì¼ ì—°ì† ì„±ê³µ ì¤‘!`;
Â  Â  Â  Â  Â  }
Â  Â  Â  }
Â  }

Â  // Buttons Logic
Â  document.getElementById("habitBtn").onclick = async () => {
Â  Â  Â  sfx.play('success');
Â  Â  Â  const user=auth.currentUser; if(!user) return;
Â  Â  Â  const name = document.getElementById("habitName").value;
Â  Â  Â  if(!name || name==="í…Œë§ˆë¥¼ ì„ íƒí•˜ì„¸ìš”") return alert("ìŠµê´€ ì…ë ¥");
Â  Â  Â Â 
Â  Â  Â  await setDoc(doc(db,"users",user.uid,"habits",dateKeyFromOffset(0)), {done:true, name, timestamp:new Date()}, {merge:true});
Â  Â  Â  await setDoc(doc(db,"users",user.uid), {updatedAt:new Date().toISOString(), lastActive: new Date()}, {merge:true});
Â  Â  Â Â 
Â  Â  Â  const ref = doc(db,"users",user.uid);
Â  Â  Â  const snap = await getDoc(ref);
Â  Â  Â  let { level=1, xp=0, coins=0, isUltra, isMaster } = snap.data() || {};
Â  Â  Â Â 
Â  Â  Â  xp+=20;
Â  Â  Â  coins += isMaster ? 3 : (isUltra ? 2 : 1);
Â  Â  Â Â 
Â  Â  Â  if(xp>=100) {Â 
Â  Â  Â  Â  Â  level++; xp-=100;
Â  Â  Â  Â  Â  sfx.play('levelUp');
Â  Â  Â  Â  Â  document.getElementById('levelUpOverlay').style.display = 'flex';
Â  Â  Â  Â  Â  confetti({particleCount: 200, spread: 120});
Â  Â  Â  } else {
Â  Â  Â  Â  Â  confetti({particleCount: 100, origin:{y:0.7}});
Â  Â  Â  }
Â  Â  Â Â 
Â  Â  Â  await setDoc(ref, {level, xp, coins}, {merge:true});
Â  Â  Â Â 
Â  Â  Â  // Global Log for Ticker
Â  Â  Â  await addDoc(collection(db, "global_logs"), {
Â  Â  Â  Â  Â  msg: `${user.email.split('@')[0]}ë‹˜ì´ [${name}] ì™„ë£Œ!`,
Â  Â  Â  Â  Â  type: "success",
Â  Â  Â  Â  Â  timestamp: new Date()
Â  Â  Â  });

Â  Â  Â  updateLevelUI(user.uid);
Â  Â  Â Â 
Â  Â  Â  const btn = document.getElementById("habitBtn");
Â  Â  Â  btn.innerHTML = "ì™„ë£Œí•¨ âœ¨"; btn.disabled=true;
Â  };

Â  document.getElementById("gachaBtn").onclick = async () => {
Â  Â  Â  sfx.play('click');
Â  Â  Â  const user=auth.currentUser; if(!user) return;
Â  Â  Â  const ref = doc(db,"users",user.uid);
Â  Â  Â  const snap = await getDoc(ref);
Â  Â  Â  let coins = snap.data().coins||0;
Â  Â  Â  if(coins<1) return alert("ì½”ì¸ ë¶€ì¡±");
Â  Â  Â Â 
Â  Â  Â  coins--;
Â  Â  Â  const p = STICKERS[Math.floor(Math.random()*STICKERS.length)];
Â  Â  Â  await updateDoc(ref, { coins, inventory: arrayUnion(p) });
Â  Â  Â Â 
Â  Â  Â  alert(`ğŸ‰ [${p}] íšë“!`);
Â  Â  Â  updateLevelUI(user.uid); loadInventory(user.uid);
Â  };

Â  // Timer
Â  let timer=null, timeLeft=1500;
Â  document.getElementById("timerBtn").onclick = () => document.getElementById("timerModal").style.display='flex';
Â  document.getElementById("startTimerBtn").onclick = () => {
Â  Â  Â  if(timer) return;
Â  Â  Â  sfx.play('click');
Â  Â  Â  timer = setInterval(() => {
Â  Â  Â  Â  Â  if(timeLeft<=0) { clearInterval(timer); sfx.play('success'); alert("ì§‘ì¤‘ ë!"); return; }
Â  Â  Â  Â  Â  timeLeft--;
Â  Â  Â  Â  Â  const m = Math.floor(timeLeft/60), s = timeLeft%60;
Â  Â  Â  Â  Â  document.getElementById("timerDisplay").innerText = `${m}:${s<10?'0':''}${s}`;
Â  Â  Â  }, 1000);
Â  };
Â  document.getElementById("stopTimerBtn").onclick = () => { clearInterval(timer); timer=null; };

Â  // Helper UIs
Â  ['rank','shop'].forEach(k => {
Â  Â  Â  document.getElementById(k+'OpenBtn').onclick = () => {
Â  Â  Â  Â  Â  sfx.play('click');
Â  Â  Â  Â  Â  document.getElementById(k+'Panel').style.display = document.getElementById(k+'Panel').style.display==='none'?'block':'none';
Â  Â  Â  Â  Â  if(k==='rank') loadLeaderboard();
Â  Â  Â  Â  Â  if(k==='shop') loadInventory(auth.currentUser.uid);
Â  Â  Â  }
Â  });

Â  async function loadLeaderboard() {
Â  Â  Â  const list = document.getElementById("rankList"); list.innerHTML="ë¡œë”©...";
Â  Â  Â  const snap = await getDocs(collection(db,"users"));
Â  Â  Â  let u = []; snap.forEach(d=>u.push(d.data()));
Â  Â  Â  u.sort((a,b)=>b.level-a.level);
Â  Â  Â  list.innerHTML = u.slice(0,10).map((x,i)=>`<div style="padding:5px; border-bottom:1px solid #eee;">${i+1}. ${x.email?.slice(0,3)}*** Lv.${x.level}</div>`).join('');
Â  }

Â  // BGM Logic
Â  const audio = document.getElementById("bgmAudio");
Â  document.getElementById("bgmOpenBtn").onclick = () => document.getElementById("bgm").style.display='block';
Â  document.getElementById("bgmToggle").onclick = () => { audio.paused ? audio.play() : audio.pause(); };
Â  document.getElementById("bgmSelect").onchange = (e) => { audio.src = e.target.value; audio.play(); };
Â Â 
Â  // Theme Toggle
Â  const toggle = document.getElementById("darkModeToggle");
Â  toggle.onclick = () => {
Â  Â  sfx.play('click');
Â  Â  document.body.classList.toggle("dark-mode");
Â  Â  localStorage.setItem("darkMode", document.body.classList.contains("dark-mode") ? "on" : "off");
Â  };
Â  if (localStorage.getItem("darkMode") === "on") document.body.classList.add("dark-mode");

Â  // Zen Mode
Â  window.toggleZenMode = () => {
Â  Â  Â  const zen = document.getElementById("zenOverlay");
Â  Â  Â  if(zen.style.display === "flex") {
Â  Â  Â  Â  Â  zen.style.opacity = 0;
Â  Â  Â  Â  Â  setTimeout(()=>zen.style.display="none", 1000);
Â  Â  Â  } else {
Â  Â  Â  Â  Â  zen.style.display = "flex";
Â  Â  Â  Â  Â  setTimeout(()=>zen.style.opacity = 1, 10);
Â  Â  Â  }
Â  };

Â  // Broadcast Listener
Â  function subscribeToBroadcast() {
Â  Â  Â  onSnapshot(doc(db, "config", "broadcast"), (doc) => {
Â  Â  Â  Â  Â  if(doc.exists()) {
Â  Â  Â  Â  Â  Â  Â  const d = doc.data();
Â  Â  Â  Â  Â  Â  Â  const diff = (new Date() - d.timestamp.toDate()) / 1000;
Â  Â  Â  Â  Â  Â  Â  if(diff < 60) {Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  sfx.play('success');
Â  Â  Â  Â  Â  Â  Â  Â  Â  const el = document.getElementById("broadcastOverlay");
Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById("broadcastMsg").innerText = d.message;
Â  Â  Â  Â  Â  Â  Â  Â  Â  el.classList.add("active");
Â  Â  Â  Â  Â  Â  Â  Â  Â  setTimeout(() => el.classList.remove("active"), 5000);
Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  }
Â  Â  Â  });
Â  }

Â  // Ticker / Matrix Listener
Â  function subscribeToGlobalLogs(isPublic = false) {
Â  Â  Â  const q = query(collection(db, "global_logs"), orderBy("timestamp", "desc"), limit(20));
Â  Â  Â  onSnapshot(q, (snap) => {
Â  Â  Â  Â  Â  snap.docChanges().forEach(change => {
Â  Â  Â  Â  Â  Â  Â  if (change.type === "added") {
Â  Â  Â  Â  Â  Â  Â  Â  Â  const data = change.doc.data();
Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  // Matrix Log (Admin Only)
Â  Â  Â  Â  Â  Â  Â  Â  Â  if(!isPublic) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const term = document.getElementById("matrixLog");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(term) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const div = document.createElement("div");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  div.className = "log-line";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  div.innerHTML = `<span>[${new Date().toLocaleTimeString()}]</span> ${data.msg}`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  term.prepend(div);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  Â  // Ticker & Cheer
Â  Â  Â  Â  Â  Â  Â  Â  Â  if (data.type === "cheer") {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  triggerHearts();
Â  Â  Â  Â  Â  Â  Â  Â  Â                    } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â                        const track = document.getElementById("tickerContent");
Â  Â  Â  Â  Â  Â  Â  Â  Â                        const item = document.createElement("div");
Â  Â  Â  Â  Â  Â  Â  Â  Â                        item.className = "ticker-item";
Â  Â  Â  Â  Â  Â  Â  Â  Â                        item.innerHTML = `âš¡ ${data.msg}`;
Â  Â  Â  Â  Â  Â  Â  Â  Â                        track.appendChild(item);
Â  Â  Â  Â  Â  Â  Â  Â  Â                    }Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  });
Â  Â  Â  });
Â  }

Â  // =========================================================
Â  // ğŸ‘‘ GOD MODE ADMIN LOGIC
Â  // =========================================================
Â Â 
Â  const adminPanel = document.getElementById("adminPanel");
Â  const adminNavBtns = document.querySelectorAll(".adminNavBtn");
Â  const panes = document.querySelectorAll(".admin-pane");
Â  const adminSubtitle = document.getElementById("adminSubtitle");
Â  const refreshAdminBtn = document.getElementById("adminRefreshBtn");

Â  // Open/Close
Â  document.getElementById("adminOpenBtn").onclick = () => {
Â  Â  Â  sfx.play('adminOpen');
Â  Â  Â  adminPanel.style.display = "block";
Â  Â  Â  adminSubtitle.textContent = `SYSTEM ACCESS: ${auth.currentUser.email}`;
Â  Â  Â  refreshAdmin();
Â  };
Â  // Close buttons (Top X and Sidebar Exit)
Â  document.querySelectorAll(".admin-close-x, .admin-exit-btn").forEach(btn => {
Â  Â  Â  btn.onclick = () => adminPanel.style.display = "none";
Â  });

Â  // Tab Switching
Â  adminNavBtns.forEach(btn => {
Â  Â  Â  btn.addEventListener("click", () => {
Â  Â  Â  Â  Â  sfx.play('click');
Â  Â  Â  Â  Â  adminNavBtns.forEach(b => b.classList.remove("active"));
Â  Â  Â  Â  Â  btn.classList.add("active");
Â  Â  Â  Â  Â  panes.forEach(p => p.classList.remove("active"));
Â  Â  Â  Â  Â  document.getElementById(btn.dataset.pane).classList.add("active");
Â  Â  Â  });
Â  });

Â  if(refreshAdminBtn) refreshAdminBtn.onclick = () => refreshAdmin();

Â  window.refreshAdmin = async () => {
Â  Â  Â  sfx.play('click');
Â  Â  Â  const snap = await getDocs(collection(db, "users"));
Â  Â  Â  const users = [];
Â  Â  Â  snap.forEach(d => users.push({id: d.id, ...d.data()}));
Â  Â  Â Â 
Â  Â  Â  // KPI
Â  Â  Â  const total = users.length;
Â  Â  Â  const pro = users.filter(u=>u.isPro).length;
Â  Â  Â  const master = users.filter(u=>u.isMaster).length;
Â  Â  Â  const free = total - pro - master;
Â  Â  Â Â 
Â  Â  Â  document.getElementById("dashTotal").innerText = total;
Â  Â  Â  document.getElementById("dashPro").innerText = pro;
Â  Â  Â  const active7 = users.filter(u=> u.lastActive && new Date(u.lastActive.seconds*1000) > new Date(Date.now()-86400000*7)).length;
Â  Â  Â  document.getElementById("dashActive").innerText = active7;

Â  Â  Â  // Draw CSS Chart
Â  Â  Â  const chart = document.getElementById("tierChart");
Â  Â  Â  if(chart) {
Â  Â  Â  Â  Â  const pFree = total > 0 ? (free/total)*100 : 0;
Â  Â  Â  Â  Â  const pPro = total > 0 ? (pro/total)*100 : 0;
Â  Â  Â  Â  Â  const pMaster = total > 0 ? (master/total)*100 : 0;
Â  Â  Â  Â  Â  chart.innerHTML = `
Â  Â  Â  Â  Â  Â  <div class="chart-bar" style="width:${pFree}%; background:#444"></div>
Â  Â  Â  Â  Â  Â  <div class="chart-bar" style="width:${pPro}%; background:#6366f1"></div>
Â  Â  Â  Â  Â  Â  <div class="chart-bar" style="width:${pMaster}%; background:#ffd700"></div>
Â  Â  Â  Â  Â  `;
Â  Â  Â  }

Â  Â  Â  // User List
Â  Â  Â  const listDiv = document.getElementById("admUserList");
Â  Â  Â  listDiv.innerHTML = "";
Â  Â  Â  users.forEach(u => {
Â  Â  Â  Â  Â  const el = document.createElement("div");
Â  Â  Â  Â  Â  el.className = "admin-card";
Â  Â  Â  Â  Â  el.style.display = "flex"; el.style.justifyContent = "space-between";
Â  Â  Â  Â  Â  el.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <b>${u.email}</b> <span style="font-size:11px; color:#aaa;">${u.id.slice(0,5)}</span><br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <span style="font-size:12px;">${u.isPro?"PRO":"FREE"} | ${u.isBanned?"BANNED":"ACTIVE"}</span>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  <button class="btn" style="font-size:11px; height:30px;" onclick="togglePro('${u.id}', ${u.isPro})">ë“±ê¸‰ë³€ê²½</button>
Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  listDiv.appendChild(el);
Â  Â  Â  });
Â  };

Â  window.togglePro = async (uid, current) => {
Â  Â  Â  await updateDoc(doc(db,"users",uid), {isPro: !current});
Â  Â  Â  refreshAdmin();
Â  };

Â  window.godModeGift = async () => {
Â  Â  Â  sfx.play('adminOpen');
Â  Â  Â  if(!confirm("ì „ì²´ ìœ ì €ì—ê²Œ 100 ì½”ì¸ì„ ì„ ë¬¼í•©ë‹ˆê¹Œ?")) return;
Â  Â  Â  const snap = await getDocs(collection(db, "users"));
Â  Â  Â  snap.forEach(async d => {
Â  Â  Â  Â  Â  await updateDoc(doc(db,"users",d.id), { coins: (d.data().coins||0)+100 });
Â  Â  Â  });
Â  Â  Â  alert("ì„ ë¬¼ ì™„ë£Œ!");
Â  };

Â  window.godModeBroadcast = async () => {
Â  Â  Â  const msg = document.getElementById("broadcastInput").value;
Â  Â  Â  if(!msg) return;
Â  Â  Â  sfx.play('adminOpen');
Â  Â  Â  await setDoc(doc(db, "config", "broadcast"), { message: msg, timestamp: new Date() });
Â  Â  Â  alert("ì „ì†¡ë¨");
Â  };

Â  window.exportCSV = () => {
Â  Â  Â  getDocs(collection(db,"users")).then(s => {
Â  Â  Â  Â  Â  let csvContent = "data:text/csv;charset=utf-8,UID,Email,Level,Coins,IsPro\n";
Â  Â  Â  Â  Â  s.forEach(d => {
Â  Â  Â  Â  Â  Â  Â  const u = d.data();
Â  Â  Â  Â  Â  Â  Â  csvContent += `${d.id},${u.email},${u.level||1},${u.coins||0},${u.isPro||false}\n`;
Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  const encodedUri = encodeURI(csvContent);
Â  Â  Â  Â  Â  const link = document.createElement("a");
Â  Â  Â  Â  Â  link.setAttribute("href", encodedUri);
Â  Â  Â  Â  Â  link.setAttribute("download", "habitflow_users.csv");
Â  Â  Â  Â  Â  document.body.appendChild(link);
Â  Â  Â  Â  Â  link.click();
Â  Â  Â  });
Â  };

</script>
</body>
</html>

